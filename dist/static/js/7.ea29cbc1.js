(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{241:function(t,i,e){},285:function(t,i,e){"use strict";var o=e(241);e.n(o).a},340:function(t,i,e){"use strict";e.r(i);var o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"v-checkState"},[t.user.isDisabled?e("com-input",{attrs:{inputVal:t.user.phone,placeholder:"请输入手机号",maxLength:11,isDisabled:"disabled",type:"mobile",errorMsg:t.phoneError},on:{"update:inputVal":function(i){t.$set(t.user,"phone",i)},"update:errorMsg":function(i){t.phoneError=i}}}):e("com-input",{attrs:{inputVal:t.user.phone,placeholder:"请输入手机号",maxLength:11,type:"mobile",errorMsg:t.phoneError},on:{"update:inputVal":function(i){t.$set(t.user,"phone",i)},"update:errorMsg":function(i){t.phoneError=i}}}),t._v(" "),t.user.isDisabled?t._e():e("com-verification-code",{attrs:{phone:t.user.phone,inputVal:t.code,code:t.code,isGetCode:t.isGetCode,placeholder:"输入验证码",maxLength:6,errorMsg:t.codeError,codeType:"CONSUMER_USER_LOGIN"},on:{"update:inputVal":function(i){t.code=i},"update:code":function(i){t.code=i},inputFocus:function(i){t.getCode(i)},"update:errorMsg":function(i){t.codeError=i}}}),t._v(" "),e("button",{staticClass:"primary-button",on:{click:t.submit}},[t._v("提交")])],1)};o._withStripped=!0;var a=e(17),n=e.n(a),s=e(264),r=e(265),c=e(226),u=e(71),d={mixins:[e(227).a],data:function(){return{MOBILE_HOST:"//test-zhike.vhall.com/m/",code:"",isGetCode:!0,activity:{viewCondition:"",countDown:"",status:""},user:{phone:"",isApplay:!1,isOrder:!1,isDisabled:!1},codeError:"",phoneError:"",isClick:!0}},mounted:function(){},components:{"com-input":s.a,"com-verification-code":r.a},created:function(){this.getActivity();var t=JSON.parse(sessionStorage.getItem("login"));t&&(this.user.phone=t.mobile,this.user.phone&&(this.user.isDisabled=!0))},watch:{},methods:{getCode:function(t){this.code=t},subScribe:function(){var t=this;if(!this.isClick)return!1;this.isClick=!1;var i={activityId:this.$route.params.id};this.$config({handlers:!0}).$post(c.a.GET_LIVEINFO,i).then(function(i){"N"!==i.data.viewLimit.canAppoint||"APPOINT"!==i.data.activity.viewCondition||i.data.joinInfo.isApplay?"LIVING"===i.data.activity.status?"APPOINT"===i.data.activity.viewCondition?i.data.joinInfo.isApplay?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):i.data.joinInfoisOrder&&"NONE"===i.data.activity.viewCondition?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):i.data.activity.countDown<1800?"APPOINT"===i.data.activity.viewCondition?i.data.joinInfoisApplay?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):i.data.joinInfoisOrder&&"NONE"===i.data.activity.viewCondition?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):(t.isClick=!0,t.phoneError="您输入的手机号未参与报名")}).catch(function(i){t.isClick=!0,t.$messageBox({header:"提示",content:i.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})})},submit:function(){var t=this;return!!this.isClick&&(this.verification(this.user.phone,"Y","mobile")?this.user.isDisabled||this.verification(this.code,"Y","code")?(this.isClick=!1,void(this.user.isOrder||this.user.isDisabled?this.subScribe():this.$config({handlers:!0}).$post(u.a.POST_MOBILELOGIN,{mobile:this.user.phone,code:this.code,wechatAuth:sessionStorage.getItem("wechatAuth")}).then(function(i){i.data?(sessionStorage.setItem("login",n()(i.data)),t.$config({handlers:!0}).$get(c.a.GET_LIVEINFO,{activityId:t.$route.params.id}).then(function(i){i.data.joinInfo.isOrder?t.$router.replace("/guide/"+t.$route.params.id):(t.isClick=!0,t.subScribe())}).catch(function(i){t.isClick=!0,t.$messageBox({header:"提示",content:i.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})})):(t.isClick=!0,t.$messageBox({header:"提示",content:i.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}}),sessionStorage.removeItem("login"),sessionStorage.removeItem("wechatAuth"))}).catch(function(i){t.isClick=!0,10020===i.code?t.codeError="请输入正确验证码":12002===i.code?"LIVING"===t.activity.status?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.activity.countDown<1800?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):t.$router.replace("/Success/"+t.$route.params.id):(t.isClick=!0,t.$messageBox({header:"提示",content:i.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}}))}))):(this.codeError="请输入正确验证码",!1):(this.phoneError="请正确填写手机号",!1))},verification:function(t,i,e){if("mobile"===e&&(t=""===this.user.phone?t:this.user.phone),"code"===e)return/^\d{6}$/.test(t);if(""===t){if("Y"===i)return!1}else switch(e){case"mobile":return t=""===this.user.phone?t:this.user.phone,/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(t);case"integer":return/^[0-9]*$/.test(t);case"email":return/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(t)}return!0},getActivity:function(){var t=this;this.$config({handlers:!0}).$get(c.a.GET_LIVEINFO,{activityId:this.$route.params.id}).then(function(i){t.activity.status=i.data.activity.status,t.activity.countDown=i.data.activity.countDown,t.activity.viewCondition=i.data.activity.viewCondition,t.user.isApplay=i.data.joinInfo.isApplay,t.user.isOrder=i.data.joinInfo.isOrder,"LIVING"===t.activity.status&&(t.user.isApplay&&"APPOINT"===t.activity.viewCondition?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):"NONE"===t.activity.viewCondition&&t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id)),t.activity.countDown<1800&&(t.user.isApplay&&"APPOINT"===t.activity.viewCondition?t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id):"NONE"===t.activity.viewCondition&&t.doAuth(t.MOBILE_HOST+"watch/"+t.$route.params.id))})}}},h=(e(285),e(1)),p=Object(h.a)(d,o,[],!1,null,"40b23aa5",null);p.options.__file="src/pages/guide/check-state.vue";i.default=p.exports}}]);
//# sourceMappingURL=7.ea29cbc1.js.map