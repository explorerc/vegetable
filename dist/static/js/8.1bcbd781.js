(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{208:function(t,a,e){},251:function(t,a,e){t.exports=e.p+"static/img/qq.png"},262:function(t,a,e){"use strict";var i=e(208);e.n(i).a},299:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"v-watch"},[t.domShow?i("div",{staticClass:"v-hearder clearfix",on:{orientationchange:function(a){t.orientationchange(a)}}},[i("span",{staticClass:"v-status"},["直播中"===t.activityInfo.statusName?i("i"):t._e(),t._v(t._s(t.activityInfo.statusName)+"\n    ")]),t._v(" "),"直播中"===t.activityInfo.statusName?i("span",{staticClass:"v-onlineNum"},[t._v(t._s(t.activityInfo.onlineNum)+"人在线")]):t._e(),t._v(" "),t._m(0),t._v(" "),i("a",{staticClass:"fr",attrs:{href:"javascript:;"},on:{click:function(a){t.subscribe()}}},[i("i",{staticClass:"v-showpsd iconfont icon-dingyue_icon"}),t._v("订阅")])]):t._e(),t._v(" "),i(t.currentView,{tag:"component",attrs:{paasParams:t.vhallParams,domShow:t.domShow}}),t._v(" "),i("message-box",{directives:[{name:"show",rawName:"v-show",value:t.subscribeShow,expression:"subscribeShow"}],on:{handleClick:function(a){t.subscribeClick(a)}}},[i("div",{attrs:{slot:"header"},slot:"header"}),t._v(" "),i("img",{staticClass:"v-logo",attrs:{src:e(251),alt:""}}),t._v(" "),i("p",{staticClass:"v-title"},[t._v("\n      北京微吼时代科技有限公司\n    ")]),t._v(" "),i("div",{staticClass:"v-from"},[i("p",{staticClass:"v-explain"},[t._v("\n        请留下您的邮箱，我们会将更多的活动推送给您\n      ")]),t._v(" "),i("com-input",{attrs:{value:t.email,placeholder:"请输入邮箱","max-length":11,errorTips:t.errorTips},on:{"update:value":function(a){t.email=a},focus:function(a){t.emailFocus()}}})],1)]),t._v(" "),i("message-box",{directives:[{name:"show",rawName:"v-show",value:t.successShow,expression:"successShow"}],attrs:{autoClose:t.autoClose},on:{handleClick:t.successClick}},[i("div",{attrs:{slot:"header"},slot:"header"}),t._v(" "),i("img",{staticClass:"v-success",attrs:{src:e(199),alt:""}}),t._v(" "),i("p",{staticClass:"v-title v-success-title"},[t._v("\n      恭喜您，订阅成功！\n    ")])]),t._v(" "),i("com-login")],1)};i._withStripped=!0;var s=e(2),n=e.n(s),o=e(30),r=e.n(o),c=e(14),h=e.n(c),l=e(10),d=e.n(l),u=e(50),v=e(295),m=e(294),p=function(){var t=this.$createElement;return(this._self._c||t)("div")};p._withStripped=!0;var f={name:"empty"},w=e(1),I=Object(w.a)(f,p,[],!1,null,null,null);I.options.__file="src/pages/watch/empty.vue";var g=I.exports,S=e(3),b=e(189),y=e(186),_=e(63),C=e(190);const x={PREPARE:"pre",LIVING:"live",FINISH:"end",PLAYBACK:"vod"},P={PREPARE:"预告",LIVING:"直播中",FINISH:"结束",PLAYBACK:"回放"};var k={mixins:[y.a],data:()=>({activityData:{},playType:"live",playStatus:"",currentView:g,vhallParams:{token:"",appId:"",channelId:"",accountId:""},subscribeShow:!1,businessUserId:"",domShow:!0,autoClose:0,email:"",errorTips:"",successShow:!1,wxShare:{wxShareData:{appId:"",timestamp:"",nonceStr:"",signature:""},shareData:{title:"",desc:"",link:"",imgUrl:""},shareUser:{shareId:""}}}),mounted(){this.storeLoginInfo(this.getLoginInfo())},computed:d()({},Object(u.c)("liveMager",{activityInfo:t=>t.activityInfo,joinInfo:t=>t.joinInfo,roomPaas:t=>t.roomPaas}),Object(u.c)("tokenMager",{chatParams:t=>t.chatParams}),Object(u.c)("login",{loginInfo:t=>t.loginInfo})),created(){const t=this.$route.params.id;t||this.$router.go(-1),this.activityId=t,this.initPage();let a=this;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){90===window.orientation||-90===window.orientation?a.domShow=!1:a.domShow=!0},!1)},methods:d()({},Object(u.b)("tokenMager",{setChatParams:S.b}),Object(u.b)("liveMager",{storeActivityInfo:S.a,storeRoomPaas:S.h,storeJoinInfo:S.d}),Object(u.b)("login",{storeLoginInfo:S.g}),{subscribe(){this.loginInfo?this.loginInfo.email?this.sendSubScribe():this.subScribeShow=!0:this.doLogin()},emailFocus(){this.errorTips=""},sendSubScribe(){b.a.sendSubscribe({businessUserId:this.activityInfo.userId,email:this.loginInfo.email}).then(t=>{if(200!==t.code)this.errorTips=t.msg;else{this.autoClose=3,this.subscribeShow=!1,this.successShow=!0;let t=JSON.parse(h()(this.loginInfo));t.email=this.emailInput,this.updateLoginInfo(t),this.storeLoginInfo(t)}})},subscribeClick(t){if("cancel"===t.action)this.subscribeShow=!1;else if("confirm"===t.action){if(!/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(this.email))return this.errorTips="邮箱格式不正确",!1;this.errorTips="",this.sendSubScribe()}},successClick(t){"cancel"===t.action?this.successShow=!1:"confirm"===t.action&&(this.successShow=!1)},initPage(){var t=this;return r()(function*(){yield t.initRoomPaas(),t.share();let a={activityId:t.$route.params.id,__errHandler:!0},e=null;yield _.a.getWebinarinfo(a).then(function(a){200===a.code&&((e=a.data.activity).setting=a.data.setting,e.statusName=P[e.status],e.description=a.data.activity.description,t.playType=x[e.status],t.playStatus=P[e.status],t.businessUserId=a.data.activity.userId,t.currentView=v.default,"vod"===t.playType?t.currentView=v.default:t.currentView=m.default,_.a.queryOnlineNum({activityId:t.$route.params.id}).then(function(a){200===a.code&&(e.onlineNum=a.data.onlineNum,t.storeActivityInfo(e))}))})})()},handleUpdateOnlineNum(t){this.activityInfo.onlineNum=t,this.storeActivityInfo(this.activityInfo)},initSdk(){},initRoomPaas(){const t=this.$route.query.shareid;let a={activityId:this.activityId,__errHandler:!0};return t&&(a.shareId=t),new n.a((t,e)=>{this.roomPaas.token&&t(this.roomPaas),_.a.getRegactivity(a).then(a=>{200===a.code?(this.storeJoinInfo(a.data),b.a.getSdkparams({activityId:this.activityId,activityUserId:a.data.activityUserId}).then(a=>{200===a.code&&a.data&&(t(a.data),this.storeRoomPaas(a.data))})):this.$router.replace("/kicked")})})},initMsgServe(){},share(){var t=this;return r()(function*(){let a=window.location.href;t.joinInfo.activityUserId&&(a=t.joinInfo.activityUserId?`${a}?shareId=${t.joinInfo.activityUserId}`:a),t.wxShare.shareData.link=a,yield _.a.getShareSign(a).then(function(a){200===a.code&&(t.wxShare.wxShareData.appId=a.data.appId,t.wxShare.wxShareData.timestamp=a.data.timestamp,t.wxShare.wxShareData.nonceStr=a.data.nonceStr,t.wxShare.wxShareData.signature=a.data.signature)}),yield _.a.getShareInfo({route:"guide_route"}).then(function(a){200===a.code&&a.data&&(t.wxShare.shareData.title=a.data.title?a.data.title:"",t.wxShare.shareData.desc=a.data.description?a.data.description:"",t.wxShare.shareData.imgUrl=a.data.imgUrl?a.data.imgUrl:"")}),Object(C.a)(t.wxShare)})()}})},N=(e(262),Object(w.a)(k,i,[function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"fr v-my",attrs:{href:"javascript:;"}},[a("i",{staticClass:"v-showpsd iconfont icon-wode_icon"}),this._v("我的")])}],!1,null,"a2747dca",null));N.options.__file="src/pages/watch/Watch.vue";a.default=N.exports}}]);
//# sourceMappingURL=8.1bcbd781.js.map