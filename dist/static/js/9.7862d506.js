(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{193:function(t,i,s){},216:function(t,i,s){"use strict";var a=s(193);s.n(a).a},85:function(t,i,s){"use strict";s.r(i);var a=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",[s("div",{staticClass:"v-video"},[s("play-video",{attrs:{role:"watcher","play-type":t.playType,startInit:t.startInit}})],1),t._v(" "),t.domShow?s("div",{staticClass:"v-function-box"},[s("div",{staticClass:"v-nav"},[s("com-tabs",{attrs:{value:t.tabValue},on:{"update:value":function(i){t.tabValue=i},change:t.tabChange}},[s("com-tab",{attrs:{label:"活动简介",index:1}},[s("div",{staticClass:"v-introduction",domProps:{innerHTML:t._s(t.activityInfo.description)}})]),t._v(" "),s("com-tab",{attrs:{label:"互动聊天",index:2}},[s("div",{staticClass:"chat-content"},[s("chating",{ref:"chatbox",attrs:{type:t.playType,isWatch:t.isWatch,sendBoxShow:t.sendBoxShow},on:{closeChatBox:t.closeChatBox,isMute:function(i){t.isMute(i)}}})],1),t._v(" "),"live"===t.playType&&t.isLogin?[t.isMuteShow?[s("div",{staticClass:"v-chat-control v-noLogin",attrs:{id:"sendBoxBtn"}},[t._v("\n                "+t._s(t.allMuted?"已开启全体禁言":"您已被禁言")+"\n              ")])]:[s("div",{staticClass:"v-chat-control",attrs:{id:"sendBoxBtn"},on:{click:function(i){t.chatClick()}}},[s("i",{staticClass:"iconfont icon-biaoqing"}),t._v(" "),s("span",{staticClass:"v-chat-clickbox"},[t._v("\n                  输入文字聊天\n                ")])])]]:"live"!==t.playType||t.isLogin?t._e():[s("div",{staticClass:"v-chat-control v-noLogin",attrs:{id:"sendBoxBtn"}},[t._v("\n              需要登录才能参与聊天 "),s("span",{on:{click:t.doLogin}},[t._v("登录")])])]],2)],1),t._v(" "),t._m(0)],1)]):t._e(),t._v(" "),s("com-login",{on:{login:t.loginSuccess}})],1)};a._withStripped=!0;var n=s(11),o=s.n(n),e=s(8),c=s.n(e),l=s(197),h=s(198),r=s(45),v=s(2),d=s(186),u=s(189),p=s(195),f={props:{domShow:Boolean},mixins:[d.a],components:{PlayVideo:l.a,Chating:h.a},data:()=>({playType:"live",startInit:!1,tabValue:1,isWatch:!0,chatListInit:!1,sendBoxShow:!1,isLogin:!1,isMuteShow:!1,allMuted:!1}),computed:c()({},Object(r.c)("liveMager",{activityInfo:t=>t.activityInfo,roomPaas:t=>t.roomPaas}),Object(r.c)("login",{loginInfo:t=>t.loginInfo})),mounted(){this.storeLoginInfo(this.getLoginInfo()),"PREPARE"===this.activityInfo.status?this.playType="warm":"FINISH"===this.activityInfo.status?this.playType="end":this.playType="live",this.startInit=!0,this.initMsgServe()},created(){this.initToken()},watch:{"loginInfo.consumerUserId":{handler(t){t&&this.isWatch&&(this.isLogin=!0)},deep:!0}},methods:c()({},Object(r.b)("login",{storeLoginInfo:v.g}),{tabChange(){if(2===this.tabValue&&(this.$refs.chatbox.aBScroll||(this.$refs.chatbox.initScroll(),this.$refs.chatbox.getHistroy()),!this.$refs.chatbox.tipsShow)){const t=this;setTimeout(function(){t.$refs.chatbox.scrollBtm()},200)}},initToken(){this.$nextTick(()=>{this.startInit=!0})},initMsgServe(){p.a.OBJ.init({accountId:this.roomPaas.accountId,token:this.roomPaas.token,appId:this.roomPaas.appId,channelId:this.roomPaas.channelRoom}),p.a.OBJ.regHandler(u.a.onLineNum,t=>{const i=JSON.parse(o()(this.liveInfo));i.showOnlineNum=parseInt(i.setting.initOnlineNum)+parseInt(t.num),this.storeLiveInfo(i)}),p.a.OBJ.regHandler(u.a.beginLive,t=>{this.playType="live";const i=JSON.parse(o()(this.activityInfo));i.status="LIVING",i.statusName="直播中",this.storeActivityInfo(i)}),p.a.OBJ.regHandler(u.a.endLive,t=>{this.playType="end";const i=JSON.parse(o()(this.activityInfo));i.status="FINISH",i.statusName="结束",this.storeActivityInfo(i)})},isMute(t){this.isMuteShow=t.isMute,this.allMuted="allMuted"===t.type},chatClick(){this.sendBoxShow=!0},closeChatBox(){this.sendBoxShow=!1},loginSuccess(t){this.storeLoginInfo(t)},loginHandler(){this.$emit("showLogin")}})},g=(s(216),s(1)),I=Object(g.a)(f,a,[function(){var t=this.$createElement,i=this._self._c||t;return i("a",{staticClass:"v-subscribe",attrs:{href:"javascript:;"}},[i("i",{staticClass:"iconfont icon-dingyue"}),this._v(" 关注")])}],!1,null,"8c492ca0",null);I.options.__file="src/pages/watch/live.vue";i.default=I.exports}}]);
//# sourceMappingURL=9.7862d506.js.map