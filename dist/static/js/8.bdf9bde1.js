(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{230:function(t,e,i){},231:function(t,e,i){},232:function(t,e,i){},233:function(t,e,i){},234:function(t,e,i){},235:function(t,e,i){},236:function(t,e,i){},237:function(t,e,i){},238:function(t,e,i){},239:function(t,e,i){},240:function(t,e,i){},241:function(t,e,i){},242:function(t,e,i){},243:function(t,e,i){},244:function(t,e,i){},245:function(t,e,i){},246:function(t,e,i){},283:function(t,e,i){"use strict";var a=i(230);i.n(a).a},284:function(t,e,i){"use strict";var a=i(231);i.n(a).a},285:function(t,e,i){"use strict";var a=i(232);i.n(a).a},286:function(t,e,i){"use strict";var a=i(233);i.n(a).a},287:function(t,e,i){t.exports=i.p+"static/img/tao.png"},288:function(t,e,i){"use strict";var a=i(234);i.n(a).a},289:function(t,e,i){"use strict";var a=i(235);i.n(a).a},290:function(t,e,i){"use strict";var a=i(236);i.n(a).a},291:function(t,e,i){"use strict";var a=i(237);i.n(a).a},292:function(t,e,i){"use strict";var a=i(238);i.n(a).a},293:function(t,e,i){"use strict";var a=i(239);i.n(a).a},294:function(t,e,i){"use strict";var a=i(240);i.n(a).a},295:function(t,e,i){"use strict";var a=i(241);i.n(a).a},296:function(t,e,i){"use strict";var a=i(242);i.n(a).a},297:function(t,e,i){"use strict";var a=i(243);i.n(a).a},298:function(t,e,i){"use strict";var a=i(244);i.n(a).a},299:function(t,e,i){"use strict";var a=i(245);i.n(a).a},300:function(t,e,i){"use strict";var a=i(246);i.n(a).a},326:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"v-watch",class:{"v-x5-div":t.vx5div,"v-close-x5-div":t.vclosex5div,"v-other-div":t.votherdiv}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.domShow,expression:"domShow"}],staticClass:"v-x5-title"},[t._v("\n    "+t._s(t.activityInfo.title)+"\n  ")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.domShow,expression:"domShow"}],staticClass:"v-hearder clearfix",on:{orientationchange:function(e){t.orientationchange(e)}}},[t.logoImg?t._e():a("span",{staticClass:"logo"}),t._v(" "),a("span",{staticClass:"logo",style:{backgroundImage:"url("+t.customLogo+")"}}),t._v(" "),a("span",{staticClass:"ac-title"},[t._v(t._s(t.activityInfo.title))]),t._v(" "),a("span",{staticClass:"v-status"},["直播中"===t.activityStatus?a("i"):t._e(),t._v(t._s(t.activityStatus)+"\n    ")]),t._v(" "),a("span",{staticClass:"v-onlineNum"},[t._v(t._s(t.showPersonCount)+"人在线")]),t._v(" "),t.loginInfo?[t._m(0)]:a("a",{staticClass:"fr v-my v-right",attrs:{href:"javascript:;"},on:{click:function(e){t.doLogin()}}},[a("i",{staticClass:"v-showpsd iconfont icon-wode_icon"}),t._v("登录")]),t._v(" "),a("a",{staticClass:"fr v-right",attrs:{href:"javascript:;"},on:{click:t.subscribe}},[a("i",{staticClass:"v-showpsd iconfont icon-dingyue_icon"}),t._v("订阅")])],2),t._v(" "),a(t.currentView,{tag:"component",attrs:{paasParams:t.vhallParams,domShow:t.domShow}}),t._v(" "),a("message-box",{directives:[{name:"show",rawName:"v-show",value:t.subscribeShow,expression:"subscribeShow"}],on:{handleClick:function(e){t.subscribeClick(e)}}},[a("div",{attrs:{slot:"header"},slot:"header"}),t._v(" "),t.defaultImg?a("img",{staticClass:"v-logo",attrs:{src:t.defaultImg,alt:""}}):t._e(),t._v(" "),a("p",{staticClass:"v-title"},[t._v("\n      "+t._s(t.companyName)+"\n    ")]),t._v(" "),a("div",{staticClass:"v-from"},[a("p",{staticClass:"v-explain"},[t._v("\n        请留下您的邮箱，我们会将更多的活动推送给您\n      ")]),t._v(" "),a("com-input",{attrs:{value:t.email,placeholder:"请输入邮箱",errorTips:t.errorTips},on:{"update:value":function(e){t.email=e},focus:function(e){t.emailFocus()}}})],1)]),t._v(" "),a("message-box",{directives:[{name:"show",rawName:"v-show",value:t.successShow,expression:"successShow"}],attrs:{autoClose:t.autoClose},on:{handleClick:t.successClick}},[a("div",{attrs:{slot:"header"},slot:"header"}),t._v(" "),a("img",{staticClass:"v-success",attrs:{src:i(218),alt:""}}),t._v(" "),a("p",{staticClass:"v-title v-success-title"},[t._v("\n      恭喜您，订阅成功！\n    ")])]),t._v(" "),t.redBagTipShow?a("message-box",{on:{handleClick:t.handleRedBagClick}},[a("div",{staticClass:"red-bag-box",attrs:{slot:"msgBox"},slot:"msgBox"},[a("i",{staticClass:"iconfont icon-close",on:{click:t.handleRedBagClick}}),t._v(" "),a("div",{staticClass:"red-bag-content"},[a("p",{staticClass:"red-bag-title"},[t._v("红包雨还剩"+t._s(t._f("fmtTimer")(t.downTimer))+"到来")]),t._v(" "),0==t.redBagInfo.condition?a("p",{staticClass:"red-bag-info "},[t._v("手速越快，红可能越大哦~")]):1==t.redBagInfo.condition?a("p",{staticClass:"red-bag-info"},[t._v("开奖前分享直播间参与红包雨活动")]):2==t.redBagInfo.condition?a("p",{staticClass:"red-bag-info tip-info"},[t._v("参与条件：开奖前发送口令参与红包雨活动")]):3==t.redBagInfo.condition?a("p",{staticClass:"red-bag-info"},[t._v("开奖前填写问卷调查参与红包雨活动")]):t._e(),t._v(" "),2==t.redBagInfo.condition?a("span",{staticClass:"red-bag-tip"},[t._v("口令："+t._s(t.redBagInfo.password))]):t._e()])])]):t._e(),t._v(" "),t.redBagTimeDownShow?a("message-box",{on:{handleClick:t.handleRedBagClick}},[a("div",{staticClass:"red-bag-box",attrs:{slot:"msgBox"},slot:"msgBox"},[a("i",{staticClass:"iconfont icon-close",on:{click:t.handleRedBagClick}}),t._v(" "),a("div",{staticClass:"red-bag-content"},[a("p",{staticClass:"red-bag-title"},[t._v("红包雨降临倒计时")]),t._v(" "),a("span",{staticClass:"time-down"},[t._v(t._s(t.timer))]),t._v(" "),a("p",{staticClass:"red-bag-info"},[t._v("点击屏幕上落下的红包，手速越快红包越大！")])])])]):t._e(),t._v(" "),t.redBagShow?a("message-box",{on:{handleClick:t.handleRedBagClick}},[a("div",{staticClass:"red-bag-box get-red-bag",attrs:{slot:"msgBox"},slot:"msgBox"},[a("i",{staticClass:"iconfont icon-close",on:{click:t.handleRedBagClick}}),t._v(" "),a("div",{staticClass:"red-bag-content"},[a("p",{staticClass:"red-bag-title"},[t._v("恭喜您抢到")]),t._v(" "),a("span",{staticClass:"red-bag-money"},[t._v("￥"+t._s(t.redBagResultInfo.amount))]),t._v(" "),a("span",{staticClass:"red-bag-detail detail-top"},[t._v("超过了"),a("span",{staticStyle:{color:"#fff"}},[t._v(t._s(t.redBagResultInfo.percent)+"%")]),t._v("的小伙伴")]),t._v(" "),a("span",{staticClass:"red-bag-detail detail-bottom"},[t._v("已收入钱包，请到个人中心提现")])])])]):t._e(),t._v(" "),t.redBagNoneShow?a("message-box",{on:{handleClick:t.handleRedBagClick}},[a("div",{staticClass:"red-bag-box red-bag-top",staticStyle:{"background-color":"#fff"},attrs:{slot:"msgBox"},slot:"msgBox"},[a("i",{staticClass:"iconfont icon-close",on:{click:t.handleRedBagClick}}),t._v(" "),a("p",{staticClass:"red-bag-title"},[t._v("天呐，您与红包擦肩而过～")]),t._v(" "),a("div",{staticClass:"top-content"},[a("p",{staticClass:"red-bag-title"},[t._v("（手气榜 TOP5）")]),t._v(" "),a("ul",{staticClass:"red-bag-list"},[t.redBagrecordList.length<=0?a("li",[a("span",{staticClass:"none-data"},[t._v("暂无数据")])]):t._l(t.redBagrecordList,function(e){return a("li",[e.avatar?a("span",{staticClass:"head-icon",style:{backgroundImage:"url("+t.$imgHost+"/"+e.avatar+")"}}):a("span",{staticClass:"head-icon"}),t._v(" "),a("span",{staticClass:"nick-name"},[t._v(t._s(e.nick_name))]),t._v(" "),a("span",{staticClass:"red-bag-money fr"},[t._v("￥"+t._s(e.amount))])])})],2)])])]):t._e(),t._v(" "),a("RedBagRain",{attrs:{rainTime:t.rainTime},on:{endRain:t.endRainHandler,selectOk:t.selectRedBag}}),t._v(" "),a("com-login",{on:{login:t.loginSuccess}})],1)};a._withStripped=!0;var s=i(10),o=i.n(s),n=i(51),r=i.n(n),l=i(74),c=i.n(l),d=i(17),u=i.n(d),v=i(12),h=i.n(v),p=i(50),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"v-video-box"},[i("div",{staticClass:"v-video"},[i("play-video",{attrs:{role:"watcher","play-type":t.playType,startInit:t.startInit}})],1),t._v(" "),t.domShow?i("div",{staticClass:"v-function-box"},[i("div",{staticClass:"v-nav"},[i("com-tabs",{attrs:{value:t.tabValue},on:{"update:value":function(e){t.tabValue=e},change:t.tabChange}},[i("com-tab",{attrs:{label:"活动简介",index:1}},[i("div",{staticClass:"v-introduction",domProps:{innerHTML:t._s(t.activityInfo.description)}})]),t._v(" "),i("com-tab",{attrs:{label:"互动聊天",index:2}},[i("div",{staticClass:"chat-content"},[i("chating",{ref:"chatbox",attrs:{type:t.playType,isWatch:t.isWatch,sendBoxShow:t.sendBoxShow},on:{closeChatBox:t.closeChatBox,isMute:function(e){t.isMute(e)}}})],1),t._v(" "),"live"===t.playType&&t.isLogin?[t.isMuteShow?void 0:[i("div",{staticClass:"v-chat-control",attrs:{id:"sendBoxBtn"},on:{click:function(e){t.chatClick()}}},[i("i",{staticClass:"iconfont icon-biaoqing"}),t._v(" "),i("span",{staticClass:"v-chat-clickbox"},[t._v("\n                  输入文字聊天\n                ")])])]]:"live"!==t.playType||t.isLogin?t._e():[i("div",{staticClass:"v-chat-control v-noLogin",attrs:{id:"sendBoxBtn"}},[t._v("\n              需要登录才能参与聊天\n              "),i("span",{on:{click:t.doLogin}},[t._v("登录")])])]],2)],1)],1)]):t._e(),t._v(" "),i("com-login",{on:{login:t.loginSuccess}})],1)};f._withStripped=!0;var m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"play-container"},["pre"==t.playType?i("div",{staticClass:"play-video-box",attrs:{id:t.playBoxId}},[t.imageSrc?i("img",{staticClass:"v-mark-img",attrs:{src:t.imageSrc}}):t._e()]):"live"==t.playType?i("div",{staticClass:"play-video-box",attrs:{id:t.playBoxId}}):"vod"==t.playType?i("div",{staticClass:"play-video-box",attrs:{id:t.playBoxId}},[i("div",{staticStyle:{width:"100%",height:"100%"},domProps:{innerHTML:t._s(this.outLineLink)}})]):"end"==t.playType?i("div",{staticClass:"play-video-box",attrs:{id:t.playBoxId}},["master"!==t.role?i("span",{staticClass:"end-box"},[t._v("直播已结束")]):t._e()]):i("div",{staticClass:"play-video-box",attrs:{id:t.playBoxId}},[t.imageSrc?i("img",{staticClass:"v-mark-img",attrs:{src:t.imageSrc}}):t._e()]),t._v(" "),t.playBtnShow?i("i",{staticClass:"iconfont icon-bofang",on:{click:t.playVideo}}):t._e(),t._v(" "),"vod"==t.playType&&!t.outLineLink||"warm"==t.playType||"live"==t.playType&&"watcher"==t.role?i("div",{staticClass:"v-click-modal",on:{click:t.modalClick}}):t._e(),t._v(" "),i("div",{staticClass:"control-box-div"},["vod"==t.playType&&!t.outLineLink||"warm"==t.playType||"live"==t.playType&&"watcher"==t.role?i("div",{staticClass:"control-video-box"},[i("video-control",{ref:"mychild",attrs:{currentTime:t.currentTime,totalTime:t.totalTime,qualitys:t.qualitys,playType:t.playType,playState:t.isPlayState,currentQuality:t.currentQuality},on:{control:t.playControl}})],1):t._e()]),t._v(" "),t.isPlay||"vod"!=t.playType&&"live"!=t.playType&&"warm"!=t.playType?t._e():i("div",{staticClass:"v-mark",on:{click:t.startPlay}},[i("i",{staticClass:"iconfont icon-bofang_anniu"})])])};m._withStripped=!0;var g=i(107),y=i.n(g),_=i(75),w=i.n(_),S=i(76),I=i.n(S),C=i(209),b=i.n(C),x=i(210),T=i.n(x),k=i(211),B=i.n(k),D=function(t){function e(t,i,a,s){w()(this,e);var o=b()(this,(e.__proto__||y()(e)).call(this,t,a,s));return o.type="live",o.roomId=i,o}return B()(e,t),I()(e,[{key:"initLivePlayer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this,i=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);console.log("1调用初始化拉流器");var a=navigator.userAgent,s={};!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||!a.match(/MicroMessenger/i)&&!a.match(/QQ/i)||(s={"x5-video-player-type":"h5","x5-video-orientation":"landscape|portrait","x5-video-player-fullscreen":!0}),window.Vhall.ready(function(){console.log("2SDK初始化完成"),window.VhallPlayer.init({roomId:e.roomId,type:"live",videoNode:e.rootEleId,videoAttr:s,complete:function(){},ready:function(){console.log("3播放器初始化完成"),i&&i(),t&&window.VhallPlayer.play()},error:function(){e.initPuller()}}),e.player=window.VhallPlayer})}},{key:"accountId",set:function(t){T()(e.prototype.__proto__||y()(e.prototype),"accoundId",t,this),console.log("aaa",this.appId,this.roomId,this.rootEleId,this.token),window.Vhall.config({appId:this.appId,accountId:t,token:this.token})}}]),e}(function(){function t(e,i,a){w()(this,t),this.appId=e,this.rootEleId=i,this.token=a,this.type="",this._accountId=null,this.player=null}return I()(t,[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.player.play(),t&&t()}},{key:"pause",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.player.pause(),t&&t()}},{key:"resume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.player.play(),t&&t()}},{key:"getQuality",value:function(){return this.player.getQuality()}},{key:"setQuality",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.player.setQuality(t),e&&e()}},{key:"setFullScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.player.setFullScreen(t),e&&e()}},{key:"isFullscreen",value:function(){return this.player.isFullscreen()}},{key:"destroy",value:function(){this.player&&this.player.destroy()}},{key:"accoundId",set:function(t){this._accountId=t},get:function(){return this._accountId}},{key:"volume",set:function(t){this.player.setVolume(t)}},{key:"width",set:function(t){this.player.setWidth(t)}},{key:"height",set:function(t){this.player.setHeight(t)}},{key:"netWorkState",get:function(){return this.player.getNetworkState()}}]),t}()),A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.controlBoxIsShow?i("div",{staticClass:"control-box"},[i("div",{staticClass:"auto-box",style:{display:t.displayVal}},["live"!=t.playType?i("div",{staticClass:"mode-item fl"},[t.isPlay?i("i",{staticClass:"iconfont icon-zanting_icon",attrs:{title:"播放"},on:{click:function(e){t.playEvent(!1)}}}):i("i",{staticClass:"iconfont icon-bofang_icon",attrs:{title:"暂停"},on:{click:function(e){t.playEvent(!0)}}})]):t._e(),t._v(" "),"live"!=t.playType?i("div",{staticClass:"mode-item time-box"},[i("span",[t._v(t._s(t.currentDate))]),t._v(" "),i("span",[t._v("/"+t._s(t.allDate))])]):t._e(),t._v(" "),"live"!=t.playType?i("div",{staticClass:"mode-item",staticStyle:{flex:"1"}},[i("div",{staticClass:"progress-box"},[i("el-slider",{attrs:{"format-tooltip":t.formatTooltip},on:{change:t.changeVal},model:{value:t.progress,callback:function(e){t.progress=e},expression:"progress"}})],1)]):t._e(),t._v(" "),"live"!=t.playType?i("div",{staticClass:"mode-item fr",on:{click:t.overEvent}},[i("span",{staticClass:"quality-info"},[t._v("画质")]),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.showQualityBlock?i("div",{staticClass:"qualitys-box"},t._l(t.qualitys,function(e,a){return i("span",{class:{"quality-item":!0,active:t.selectQuality==a},on:{click:function(e){e.stopPropagation(),t.selectQualityFn(a)}}},[t._v(t._s(e))])})):t._e()])],1):t._e(),t._v(" "),i("div",{ref:"setFullScreen",staticClass:"mode-item fr"},[i("i",{staticClass:"iconfont icon-zuidahua_icon",on:{click:t.fullScreeEvent}})])])]):t._e()};A._withStripped=!0;var P="mute",L="play",O="volumeSize",q="selectQuality",E="fullBrowser",N="progress",V={mute:"声音控制",play:"播放控制",volumeSize:"声音大小",fullScree:"全屏控制",selectQuality:"画质量",fullBrowser:"浏览器-全屏",progress:"播放进度"},j={name:"control",data:function(){return{mute:!1,isPlay:!0,volumeSize:100,fullScree:!1,isFullBrowser:!1,showQualityBlock:!1,selectQuality:0,current:0,progress:0,controlBoxIsShow:!0,interval:null}},computed:{allDate:function(){return this.formatDate(this.totalTime)},currentDate:function(){return this.formatDate(this.currentTime)},rate:function(){return parseInt(100*this.currentTime/this.totalTime)},displayVal:function(){return"live"===this.playType?"block":"flex"}},props:{currentTime:{type:Number,default:0},totalTime:{type:Number,default:1e3},qualitys:{type:Array,default:["same"]},playType:{type:String,required:!0,default:""},currentQuality:String},watch:{currentTime:{handler:function(t){this.current=t},immediate:!0},rate:{handler:function(t){this.progress=t},immediate:!0},volumeSize:function(t){this.changeControl(O,t)},currentQuality:{handler:function(t){this.selectQuality=this.qualitys.indexOf(t)}}},methods:{changeControl:function(t,e){this.$emit("control",{type:t,value:e,msg:V[t]})},formatTooltip:function(t){return t+"%"},changeVal:function(){this.changeControl(N,this.progress)},muteEvent:function(){this.mute=!this.mute,this.changeControl(P,this.mute)},overEvent:function(){this.showQualityBlock=!0},outEvent:function(){this.showQualityBlock=!1},playEvent:function(t){this.isPlay=t,this.changeControl(L,this.isPlay)},fullScreeEvent:function(){this.isX5()?alert("请把手机横屏放置"):window.VhallPlayer.setFullScreen(!0)},fullBrowser:function(){this.isFullBrowser=!this.isFullBrowser,this.changeControl(E,this.isFullBrowser)},formatDate:function(t){var e=(t/3600>>0)+"",i=((t/60%60>>0)+"").padStart(2,0),a=((t%60>>0)+"").padStart(2,0);return e>0?e+":"+i+":"+a:i+":"+a},selectQualityFn:function(t){this.selectQuality!==t&&(this.selectQuality=t,this.changeControl(q,this.qualitys[t]),this.showQualityBlock=!1)},changeControlStatus:function(){var t=this;this.controlBoxIsShow=!0,clearInterval(this.interval),this.interval=setInterval(function(){t.controlBoxIsShow=!1,clearInterval(t.interval)},5e3)},isX5:function(){var t=navigator.userAgent;return!(!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||!t.match(/MicroMessenger/i)&&!t.match(/QQ/i))}}},M=(i(283),i(1)),H=Object(M.a)(j,A,[],!1,null,"a65f7196",null);H.options.__file="src/pages/watch/video/control.vue";var G=H.exports,U=i(3),R=i(213),z=i(216),J={name:"index",components:{VideoControl:G},data:function(){return{playComps:{},playBtnShow:!1,imageUrl:"",recordId:"",outLineLink:"",playBoxId:"play-vides-"+Math.random(),sdkPlayParam:{appId:"",accountId:"",token:""},currentTime:0,totalTime:1e4,stInterval:"",isPlay:!1,isAutoPlay:!1,controlPsoition:"1.333vw",qualitys:[],currentQuality:"",isPlayState:!1}},props:{role:{type:String,default:"watcher"},playType:{type:String,required:!0,default:""},startInit:{type:Boolean,required:!0,default:!1},paasParams:{appId:"",roomId:"",inavId:"",token:"",accountId:""}},computed:h()({},Object(p.c)("liveMager",{liveDevices:function(t){return t.liveDevices},roomPaas:function(t){return t.roomPaas},activityInfo:function(t){return t.activityInfo}}),{imageSrc:function(){return this.imageUrl?this.$imgHost+"/"+this.imageUrl:"//cnstatic01.e.vhall.com/static/img/v35-webinar.png"}}),created:function(){var t=this;z.a.$on("exitFullScreen",function(){t.isPlay=!1})},mounted:function(){var t=this;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){90===window.orientation||-90===window.orientation?(t.$emit("orientationchange","horizontalScreen"),t.horizontalScreen()):(t.herticalScreen(),t.$emit("orientationchange","herticalScreen"))},!1)},watch:{startInit:function(t){t||this.stopPlay()},playType:{handler:function(){this.changePlayType()}},liveDevices:function(){this.changeLiveDevice()}},beforeDestroy:function(){console.log("--video-com--beforeDestroy"),clearInterval(this.setIntervalHandler),window.hostPusher&&window.hostPusher.destroy(),window.playComps&&window.playComps.destroy(),window.VhallPlayer&&window.VhallPlayer.destroy()},methods:h()({},Object(p.b)("liveMager",{storeRoomPaas:U.j}),{initComponent:function(){this.isPlay=!1,this.destoryComs(),"live"===this.playType?this.initLivePlay():"pre"===this.playType?this.imageUrl=this.activityInfo.imgUrl:"warm"===this.playType?this.queryWarmInfo():"vod"===this.playType?this.initPlayBack():"end"===this.playType&&this.playEnd()},changePlayType:function(){this.startInit&&-1!=="live|warm|vod|end|pre".indexOf(this.playType)&&(this.isAutoPlay=!1,this.destoryComs(),this.initComponent())},playEnd:function(){clearInterval(this.setIntervalHandler),window.hostPusher&&window.hostPusher.destroy(),window.playComps&&window.playComps.destroy(),window.VhallPlayer&&window.VhallPlayer.destroy()},playVideo:function(){"warm"===this.playType&&this.playBackVideo()},startPlay:function(){var t=this.activityInfo.warm;"warm"===this.playType&&t.record.list.length<=0?this.$messageBox({header:"提示",content:"此时没有暖场视频",confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}}):(this.isPlay=!this.isPlay,this.imageUrl="",this.qualitys=window.VhallPlayer.getQualitys(),window.VhallPlayer.play(),"live"!==this.playType&&this.dealWithVideo())},changeLiveDevice:function(){window.hostPusher&&window.hostPusher.changeSetting({conf:{video:{deviceId:this.liveDevices.camera},audio:{deviceId:this.liveDevices.mic},videoSize:[640,480,640,480]}})},initLivePlay:function(){"watcher"===this.role&&this.initPuller()},initPlayBack:function(){var t=this;this.$config({handlers:!0}).$get(R.a.GET_DEFAULEREPLAY,{activityId:this.$route.params.id}).then(function(e){e.data&&(t.imageUrl=e.data.cover,"LINK"===e.data.replay.type?t.outLineLink=e.data.replay.link:"VIDEO"!==e.data.replay.type&&"SLICE"!==e.data.replay.type||(t.recordId=e.data.replay.video,t.totalTime=e.data.replay.duration,t.playBackVideo()))}).catch(function(){})},playBackVideo:function(){var t=this;this.$nextTick(function(){if(t.recordId){var e={};t.isX5()&&(e={"x5-video-player-type":"h5","x5-video-orientation":"landscape|portrait","x5-video-player-fullscreen":!0}),window.Vhall.ready(function(){window.VhallPlayer.init({recordId:t.recordId,type:"vod",videoNode:t.playBoxId,videoAttr:e,complete:function(){t.playBtnShow=!1,t.qualitys=window.VhallPlayer.getQualitys(),t.isX5()?(document.getElementsByClassName("vjs-tech")[0].addEventListener("x5videoexitfullscreen",function(){t.changeX5ExitFullScreen()}),document.getElementsByClassName("vjs-tech")[0].addEventListener("x5videoenterfullscreen",function(){t.changeX5EnterFullScreen()})):(document.getElementsByClassName("vjs-tech")[0].style.height="56.267vw",document.getElementsByClassName("vjs-tech")[0].style["margin-top"]="16vw")},end:function(){z.a.$emit("play_back_video_completed")}})}),window.Vhall.config({appId:t.roomPaas.appId,accountId:t.roomPaas.accountId,token:t.roomPaas.token})}})},dealWithVideo:function(){clearInterval(this.setIntervalHandler);var t=this;t.setIntervalHandler=setInterval(function(){t.currentTime=window.VhallPlayer.getCurrentTime(),t.totalTime<=t.currentTime&&(clearInterval(t.setIntervalHandler),t.isAutoPlay?(window.VhallPlayer.play(),t.dealWithVideo()):(t.isPlay=!1,t.currentTime=0)),"live"!==t.playType&&window.VhallPlayer.getCurrentQuality&&(t.currentQuality=window.VhallPlayer.getCurrentQuality())},1e3)},queryWarmInfo:function(){var t=this.activityInfo.warm;this.imageUrl=t.imgUrl,this.playBtnShow=!0,this.filename=t.filename,this.recordId=t.recordId,this.isAutoPlay="AUTO"===t.playType,this.isPlayState=this.isAutoPlay,this.totalTime=parseInt(t.record.duration),this.playBackVideo()},initPuller:function(){var t=this;window.playComps&&window.playComps.destroy(),this.$nextTick(function(){t.playComps=new D(t.roomPaas.appId,t.roomPaas.liveRoom,t.playBoxId,t.roomPaas.token),t.playComps.initLivePlayer(!1,!0,function(){t.isX5()?(document.getElementsByClassName("vjs-tech")[0].addEventListener("x5videoexitfullscreen",function(){t.changeX5ExitFullScreen()}),document.getElementsByClassName("vjs-tech")[0].addEventListener("x5videoenterfullscreen",function(){t.changeX5EnterFullScreen()})):(document.getElementsByClassName("vjs-tech")[0].style.height="56.267vw",document.getElementsByClassName("vjs-tech")[0].style["margin-top"]="16vw"),console.log("----------开始播放----------")}),t.playComps.accountId=t.roomPaas.accountId})},pullBroadCast:function(){var t=this;this.hostPusher.stopBroadCast().then(function(){t.hostPusher.startBroadCast().then(function(){console.log("----------旁路推流成功----------")}).catch(function(e){console.error("旁路推流失败:"+e);var i=setTimeout(function(){clearTimeout(i),t.pullBroadCast()},500)})}).catch(function(t){console.error("停止旁路推流失败:"+t)})},stopPlay:function(){"live"===this.playType&&window.hostPusher.stop()},showVideo:function(t){this.isShowVideo=t,"live"===this.playType?"master"===this.role?window.hostPusher.showVideo(t):"watcher"===this.role&&window.playComps.showVideo(t):"warm"===this.playType||this.playType},mutoAuto:function(t){this.isMutoAuto=t,"live"===this.playType?"master"===this.role?window.hostPusher.mute(t):"watcher"===this.role&&(window.playComps.volume=t?0:50):"warm"===this.playType||this.playType},formatTooltip:function(t){return t/1e4},formatTime:function(t){var e={hour:"",min:"",sed:""};return e.hour=((t/3600%24>>0)+"").padStart(2,0),e.min=((t/60%60>>0)+"").padStart(2,0),e.sed=((t%60>>0)+"").padStart(2,0),e.hour+":"+e.min+":"+e.sed},fullScreen:function(){alert("请把手机横评放置")},horizontalScreen:function(){this.isShowCover=!1,this.height="100%",this.controlPsoition="9.333vw"},herticalScreen:function(){this.isShowCover=!0,this.height="56.267vw",this.controlPsoition="1.333vw"},start:function(){this.isStart=!0,this.puller.play()},play:function(t){"warm"!==this.playType&&"vod"!==this.playType||(t?window.VhallPlayer.play():window.VhallPlayer.pause())},playControl:function(t){var e=t.type;"progress"===e?this.seekProgress(t.value):"play"===e?this.play(t.value):"mute"===e?this.mutoAuto(t.value):"volumeSize"===e?this.changeVolume(t.value):"selectQuality"===e?window.VhallPlayer.setQuality(t.value):"fullScree"===e?this.fullScree(t.value):"fullBrowser"===e&&this.$emit("fullBrowser",t.value)},seekProgress:function(t){window.VhallPlayer&&window.VhallPlayer.seek(this.totalTime*t/100)},destoryComs:function(){clearInterval(this.setIntervalHandler),window.hostPusher&&window.hostPusher.destroy(),window.playComps&&window.playComps.destroy(),window.VhallPlayer&&window.VhallPlayer.destroy()},modalClick:function(){this.$refs.mychild.changeControlStatus()},isX5:function(){var t=navigator.userAgent;return!(!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||!t.match(/MicroMessenger/i)&&!t.match(/QQ/i))},changeX5EnterFullScreen:function(){z.a.$emit("enterFullScreen",function(){})},changeX5ExitFullScreen:function(){z.a.$emit("exitFullScreen",function(){})}})},F=(i(284),Object(M.a)(J,m,[],!1,null,"2bb9b82a",null));F.options.__file="src/pages/watch/video/index.vue";var W=F.exports,X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chat-wrap",on:{click:t.boxClick}},[t.announceShow?i("div",{staticClass:"announce-box"},[i("svg",{staticClass:"icon",staticStyle:{width:"6.667vw",height:"6.667vw","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},attrs:{viewBox:"0 0 1305 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3285"}},[i("path",{attrs:{d:"M236.3648 689.6384a102.4 102.4 0 0 1 144.6144 7.5776l119.9104 133.1712a102.4 102.4 0 1 1-152.2176 137.0368l-119.9104-133.1712a102.4 102.4 0 0 1 7.6032-144.64z",fill:"#222222","p-id":"3286"}}),t._v(" "),i("path",{attrs:{d:"M277.4528 734.4384a25.6 25.6 0 0 0-1.8944 36.1472l119.9104 133.1968a25.6 25.6 0 0 0 38.0672-34.2784l-119.9104-133.1712a25.6 25.6 0 0 0-36.1728-1.8944z",fill:"#FFD021","p-id":"3287"}}),t._v(" "),i("path",{attrs:{d:"M144.5888 482.4832l47.2064-12.416a464.8448 464.8448 0 0 0 278.3744-207.104l72.832-119.1168c-15.3088 169.7024-7.9104 291.7888 22.1696 366.208 30.08 74.4704 107.52 162.304 232.2944 263.6032l-138.3168-37.7088a456.064 456.064 0 0 0-342.9376 42.1376l-42.5472 23.8336a173.6704 173.6704 0 0 1-245.9392-86.4256 173.6704 173.6704 0 0 1 116.864-233.0112z",fill:"#222222","p-id":"3288"}}),t._v(" "),i("path",{attrs:{d:"M211.328 544.3328l-47.2064 12.4416a96.8448 96.8448 0 0 0-59.904 141.056 96.8704 96.8704 0 0 0 131.8656 37.12l42.5472-23.8336a532.8384 532.8384 0 0 1 389.632-52.1472L528.896 313.9328a541.7728 541.7728 0 0 1-317.5424 230.4z",fill:"#FFD021","p-id":"3289"}}),t._v(" "),i("path",{attrs:{d:"M819.5072 795.9552c-94.4896 38.1696-217.088-93.1072-293.3248-281.856-76.2624-188.7232-79.2832-368.3072 15.2064-406.5024 94.5152-38.144 217.088 93.1328 293.3504 281.856 76.2368 188.7232 79.2576 368.3072-15.232 406.5024z",fill:"#222222","p-id":"3290"}}),t._v(" "),i("path",{attrs:{d:"M790.7328 724.736c12.9792-5.248 24.2944-35.7888 23.424-88.0384-1.024-61.3888-18.7904-139.6736-50.6368-218.496s-73.472-147.456-115.3536-192.3072c-35.6608-38.1952-65.024-52.3264-78.0032-47.104s-24.2688 35.8144-23.3984 88.064c1.024 61.3888 18.7648 139.6736 50.6112 218.496s73.472 147.456 115.3792 192.3328c35.6608 38.1696 65.024 52.3008 77.9776 47.0528z",fill:"#FFD021","p-id":"3291"}}),t._v(" "),i("path",{attrs:{d:"M668.8256 525.4912a76.8 76.8 0 1 1-57.5488-142.3872 76.8 76.8 0 0 1 57.5488 142.3872zM840.9088 233.2928a38.4 38.4 0 1 1-50.176-58.1376l172.544-148.8896a38.4 38.4 0 1 1 50.1504 58.1376l-172.544 148.8896zM951.04 575.1552a38.4 38.4 0 0 1-3.712-76.7232l256.9472-12.3648a38.4 38.4 0 0 1 3.6864 76.7232l-256.9472 12.3648zM902.4 407.9872a38.4 38.4 0 1 1-31.9488-69.8368l370.0736-169.344a38.4 38.4 0 1 1 31.9488 69.8368L902.4 407.9872zM201.3696 637.8496a25.6 25.6 0 1 1-12.1856-49.7152c14.08-3.456 24.576-6.144 31.488-8.0128a25.6 25.6 0 1 1 13.5936 49.3312c-7.4752 2.0736-18.4064 4.864-32.896 8.3968z m111.1552-35.4048a25.6 25.6 0 1 1-20.864-46.7712c40.2688-17.9712 84.7872-42.5216 133.4272-73.6256a25.6 25.6 0 1 1 27.5712 43.136c-50.688 32.4096-97.3568 58.1632-140.1344 77.2608z",fill:"#222222","p-id":"3292"}})]),t._v(" "),i("com-marquee",{staticClass:"marquee",attrs:{content:t.receiveAnnounce},on:{over:function(e){t.announceShow=!1}}}),t._v(" "),i("i",{staticClass:"iconfont icon-close",on:{click:function(e){t.announceShow=!1}}})],1):t._e(),t._v(" "),i("div",{ref:"bscroll",staticClass:"bscroll",class:"live"!==t.type?"vod":"live",on:{mouseover:function(e){t.stopScroll=!0},mouseout:function(e){t.stopScroll=!1},scroll:function(e){t.scrollEvent(e)}}},[i("ol",{staticClass:"chat-list bscroll-container"},t._l(t.chatData,function(e,a){return"RED_PACKET_JOIN"!==e.detail.type?i("li",{key:a,class:{right:(t.joinInfo.consumerUserId?t.joinInfo.consumerUserId:t.joinInfo.visitId)==e.id},attrs:{"data-joinId":e.id}},["chat"===e.msgType?[i("dl",{staticClass:"clearfix"},[null!==e.avatar&&""!==e.avatar&&"//static.vhallyun.com/public/static/img/null.png"!==e.avatar?i("dt",[i("img",{attrs:{src:""+t.imgHost+e.avatar}})]):i("dt",{staticClass:"avatar"},[t._v(t._s(e.name&&e.name.substr(0,1)))]),t._v(" "),i("dd",[i("div",{staticClass:"name"},[t._v(t._s(e.name)+"\n                  "),e.detail.role?i("em",[t._v(t._s(e.detail.role))]):t._e()]),t._v(" "),i("div",{staticClass:"txt",domProps:{innerHTML:t._s(e.detail.txt)}})])])]:[i("div",{staticClass:"sales-tool-box",class:e.detail.type},[i("div",{staticClass:"name"},[t._v(t._s(e.detail.nickname))]),t._v(" "),"GOODS_PUSH"===e.detail.type?i("span",[t._v("推送了 "),i("em",{on:{click:function(i){t.moreInfo("goods",e.detail.goods_id)}}},[t._v("商品")]),t._v("，赶快看看吧")]):t._e(),t._v(" "),"RECOMMEND_CARD_PUSH"===e.detail.type?i("span",[t._v("推送了 "),i("em",{on:{click:function(i){t.moreInfo("cards",e.detail.recommend_card_id)}}},[t._v("卡片")]),t._v("，赶快分享吧")]):t._e(),t._v(" "),"NAIRE"===e.detail.type?i("span",[t._v("推送了 "),i("em",{on:{click:function(i){t.moreInfo("ques",e.detail.recommend_card_id)}}},[t._v("问卷")]),t._v("，赶快参与吧")]):t._e(),t._v(" "),"RED_PACKET_PUSH"===e.detail.type?i("span",[t._v("推送了 "),i("em",{on:{click:function(i){t.moreInfo("redpack",e.detail.recommend_card_id)}}},[t._v("红包雨")]),t._v("，赶快去抢吧")]):t._e()])]],2):t._e()})),t._v(" "),t.tipsShow&&t.tipsCount>0?i("transition",[i("span",{staticClass:"msg-tips",on:{click:t.scrollBottom}},[t._v("有"+t._s(t.tipsCount)+"条新消息\n          "),i("i",{staticClass:"iconfont icon-xiangxia"})])]):t._e()],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:("live"===t.type||"warm"===t.type||"pre"===t.type)&&t.isLogin&&t.sendBoxShow,expression:'(type === "live" || type === "warm"  || type === "pre") && isLogin && sendBoxShow'}],staticClass:"v-send-box-bg"},[i("div",{staticClass:"send-box clearfix",attrs:{id:"sendBox"}},[i("div",{staticClass:"top"},[i("span",{staticClass:"cancel-btn fl",on:{click:t.cancelClick}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"v-title"},[t._v("\n            聊天\n          ")]),t._v(" "),(t.mute||t.allMuted)&&t.isWatch?void 0:[i("span",{staticClass:"send-btn fr",on:{click:t.sendAction}},[t._v("发送")])],t._v(" "),"HOST"!==t.joinInfo.roleName||t.isWatch?t._e():i("div",{staticClass:"fr"},[i("i",{staticClass:"icon-swap",attrs:{title:"切换发送聊天/公告"},on:{click:function(e){t.swapAnnounce?t.swapAnnounce=!1:t.swapAnnounce=!0}}}),t._v(" "),i("div",{staticClass:"switch-box"},[i("span",[t._v("全体禁言")]),t._v(" "),i("el-switch",{staticClass:"switch",attrs:{"inactive-color":"#DEE1FF",width:32,"active-color":"#FFD021"},on:{change:t.muteAll},model:{value:t.allMuted,callback:function(e){t.allMuted=e},expression:"allMuted"}})],1)])],2),t._v(" "),i("div",{staticClass:"bottom clearfix"},[t.swapAnnounce?[i("com-input",{staticClass:"inp",attrs:{value:t.value,placeholder:t.chatPlaceholder,"max-length":140,isCharacter:!0,type:"textarea"},on:{"update:value":function(e){t.value=e}}})]:[i("com-input",{staticClass:"inp",attrs:{value:t.valueAnnounce,placeholder:t.announcePlaceholder,"max-length":140,isCharacter:!0,type:"textarea"},on:{"update:value":function(e){t.valueAnnounce=e}}})],t._v(" "),i("div",{staticClass:"v-emoji"},[i("i",{staticClass:"iconfont icon-biaoqing",attrs:{title:"表情"},on:{click:function(e){return e.stopPropagation(),t.changeFace(e)}}}),t._v(" "),t.faceOpen?i("div",{staticClass:"face-box"},t._l(t.faceArr,function(e,a){return i("img",{key:a,attrs:{src:"//cnstatic01.e.vhall.com/static/img/arclist/Expression_"+(a+1)+"@2x.png"},on:{click:function(e){e.stopPropagation(),t.inFace(a)}}})})):t._e()])],2)])])])};X._withStripped=!0;var Y=i(30),Q=i.n(Y),K=i(215),Z={name:"chat",data:function(){return{vhallParams:{token:"",appId:"",channelId:"",accountId:""},activityId:this.$route.params.id,value:"",valueAnnounce:"",receiveAnnounce:"",service:null,chatData:[],tipsShow:!1,announceShow:!1,faceOpen:!1,swapAnnounce:!0,mute:!1,allMuted:!1,tipsCount:0,timer:null,isLogin:!1,stopScroll:!1,chatPlaceholder:"输入想说的话…",announcePlaceholder:"请输入公告内容",aBScroll:null,imgHost:"//test-zhike.oss-cn-beijing.aliyuncs.com/",scrollEvent:null,faceArr:[{"[微笑]":"1"},{"[撇嘴]":"2"},{"[色]":"3"},{"[发呆]":"4"},{"[得意]":"5"},{"[流泪]":"6"},{"[害羞]":"7"},{"[闭嘴]":"8"},{"[睡]":"9"},{"[哭]":"10"},{"[尴尬]":"11"},{"[发怒]":"12"},{"[调皮]":"13"},{"[呲牙]":"14"},{"[惊讶]":"15"},{"[难过]":"16"},{"[酷]":"17"},{"[汗]":"18"},{"[抓狂]":"19"},{"[吐]":"20"},{"[偷笑]":"21"},{"[愉快]":"22"},{"[白眼]":"23"},{"[傲慢]":"24"},{"[饥饿]":"25"},{"[困]":"26"},{"[惊恐]":"27"},{"[流汗]":"28"},{"[憨笑]":"29"},{"[悠闲]":"30"},{"[奋斗]":"31"},{"[咒骂]":"32"},{"[疑问]":"33"},{"[嘘]":"34"},{"[晕]":"35"},{"[疯了]":"36"},{"[衰]":"37"},{"[骷髅]":"38"},{"[敲打]":"39"},{"[再见]":"40"},{"[擦汗]":"41"},{"[抠鼻]":"42"},{"[鼓掌]":"43"},{"[糗大了]":"44"},{"[坏笑]":"45"},{"[左哼哼]":"46"},{"[右哼哼]":"47"},{"[哈欠]":"48"},{"[鄙视]":"49"},{"[委屈]":"50"},{"[快哭了]":"51"},{"[阴险]":"52"},{"[亲亲]":"53"},{"[吓]":"54"},{"[可怜]":"55"},{"[菜刀]":"56"},{"[西瓜]":"57"},{"[啤酒]":"58"},{"[篮球]":"59"},{"[乒乓]":"60"},{"[咖啡]":"61"},{"[饭]":"62"},{"[猪头]":"63"},{"[玫瑰]":"64"},{"[凋谢]":"65"},{"[嘴唇]":"66"},{"[爱心]":"67"},{"[心碎]":"68"},{"[蛋糕]":"69"},{"[闪电]":"70"},{"[炸弹]":"71"},{"[刀]":"72"},{"[足球]":"73"},{"[瓢虫]":"74"},{"[便便]":"75"},{"[月亮]":"76"},{"[太阳]":"77"},{"[礼物]":"78"},{"[拥抱]":"79"},{"[强]":"80"},{"[弱]":"81"},{"[握手]":"82"},{"[胜利]":"83"},{"[抱拳]":"84"},{"[勾引]":"85"},{"[拳头]":"86"},{"[差劲]":"87"},{"[爱你]":"88"},{"[NO]":"89"},{"[OK]":"90"}]}},props:{type:{type:String,default:"live"},isWatch:{type:Boolean,default:!1},sendBoxShow:{type:Boolean,default:!1}},computed:h()({},Object(p.c)("liveMager",{roomPaas:function(t){return t.roomPaas},activityInfo:function(t){return t.activityInfo},joinInfo:function(t){return t.joinInfo}}),Object(p.c)("tokenMager",{chatParams:function(t){return t.chatParams}}),Object(p.c)("login",{loginInfo:function(t){return t.loginInfo}})),mounted:function(){var t=this;this.isWatch||(this.isLogin=!0),this.scrollEvent=this.debounce(function(e){t.$refs.bscroll.offsetHeight+t.$refs.bscroll.scrollTop>t.$refs.bscroll.scrollHeight-100&&(t.tipsCount=0);var i=document.getElementsByClassName("chat-list")[0].offsetHeight;.5*i>document.getElementsByClassName("live")[0].offsetHeight&&.5*i>t.$refs.bscroll.scrollTop?t.tipsShow=!0:t.tipsShow=!1},50),this.getHistroy()},methods:h()({},Object(p.b)("tokenMager",{setChatParams:U.c}),Object(p.b)("liveMager",{storeJoinInfo:U.f}),{debounce:function(t,e,i){var a;return function(){var s=this,o=arguments,n=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||t.apply(s,o)},e),n&&t.apply(s,o)}},initSdk:function(){var t={channelId:this.roomPaas.channelRoom};Q()(this.roomPaas,t),K.a.OBJ.init(this.roomPaas),K.a.OBJ.regHandler("chat",this.listenChat),K.a.OBJ.regHandler("ANNOUNCEMENT",this.listenAnnounce),K.a.OBJ.regHandler("KICK",this.listenKick),K.a.OBJ.regHandler("DISABLE_KICK",this.listenCancelkick),K.a.OBJ.regHandler("GAG",this.listenMute),K.a.OBJ.regHandler("DISABLE_GAG",this.listenCancelmute),K.a.OBJ.regHandler("GAG_ALL",this.listenAllmute),K.a.OBJ.regHandler("DISABLE_GAG_ALL",this.listenCancelallmute)},changeFace:function(){this.faceOpen=!this.faceOpen},sendAction:function(){if(!this.value.replace(/\n/g,"").length)return this.chatPlaceholder="聊天内容不能为空",!1;var t="HOST"===this.joinInfo.roleName?"主持人":"";K.a.OBJ.activityId=this.activityId;var e={role:t,txt:this.value};K.a.OBJ.sendChat(u()(e)),_log.track(Vhall_User_Actions.CHAT,{event:encodeURIComponent(this.value)}),z.a.$emit("red_packet",this.value),this.value="",this.chatPlaceholder="输入想说的话…",this.faceOpen=!1,this.$emit("closeChatBox",!0)},listenChat:function(t){console.log("接收 聊天消息",t),this.reArrange(t),this.tipsShow&&this.tipsCount++},listenAnnounce:function(t){console.log("接收 公告消息",t),this.announceShow=!0,this.receiveAnnounce=t.content},listenKick:function(t){console.log("接收 踢出消息",t),this.refreshList(t.activityUserId,"isKick","Y"),this.isSelf(t.activityUserId)&&this.$router.push({path:"/kicked"})},listenCancelkick:function(t){console.log("接收 取消踢出消息"+t),this.refreshList(t.activityUserId,"isKick","N")},listenMute:function(t){console.log("接收 禁言消息",t),this.refreshList(t.activityUserId,"isGag","Y"),this.isSelf(t.activityUserId)&&(this.mute=!0)},listenCancelmute:function(t){this.refreshList(t.activityUserId,"isGag","N"),console.log("接收 取消禁言消息",t),this.isSelf(t.activityUserId)&&(this.mute=!1)},listenAllmute:function(t){console.log("接收 全体禁言消息",t),this.allMuted=!0},listenCancelallmute:function(t){console.log("接收 取消全体禁言消息",t),this.allMuted=!1},isSelf:function(t){return(this.joinInfo.consumerUserId?this.joinInfo.consumerUserId:this.joinInfo.visitId)===t},refreshList:function(t,e,i){this.chatData.forEach(function(a){1*a.id==1*t&&(a[e]=i)})},reArrange:function(t){var e={};if(e.detail=JSON.parse(t.data),"MARKET_TOOL"===t.third_party_user_id?e.msgType="marketTool":(e.msgType="chat",e.id=t.third_party_user_id,e.avatar=t.avatar,e.name=t.nick_name,e.isGag=t.isGag,e.isKick=t.isKick,this.faceArr.forEach(function(t,i){for(var a in t){var s=a.replace(/\[/,"\\[").replace(/\]/,"\\]"),o=new RegExp(s,"g");e.detail.txt=e.detail.txt.replace(o,"<img src='//cnstatic01.e.vhall.com/static/img/arclist/Expression_"+t[a]+"@2x.png'>")}})),this.chatData.push(e),!this.tipsShow&&!this.stopScroll){var i=this;setTimeout(function(){i.scrollBottom()},200)}this.stopScroll&&(this.tipsShow=!0)},sendAnnounce:function(){var t=this;if(!this.valueAnnounce.replace(/\n/g,"").length)return this.announcePlaceholder="公告内容不能为空",!1;var e={activityId:this.activityId,message:this.valueAnnounce};this.$get(R.a.GET_SENDANNOUNCEMENT,e).then(function(e){t.$toast({content:"公告发送成功"}),t.valueAnnounce="",t.announcePlaceholder="请输入公告内容",t.$emit("closeChatBox",!0)})},cancelClick:function(){this.$emit("closeChatBox",!0)},scrollBottom:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=document.querySelector(".bscroll"),i=e.scrollHeight-e.offsetHeight,a=setInterval(function(){e.scrollTop<i?e.scrollTop+=t:clearInterval(a)},0);this.tipsCount=0},inFace:function(t){for(var e in this.faceArr[t])this.value+=e;this.faceOpen=!this.faceOpen,document.getElementsByClassName("inp")[0].children[0].focus()},boxClick:function(t){"icon-emoji"!==t.target.className&&(this.faceOpen=!1)},getHistroy:function(){var t=this;this.$get(R.a.GET_MESSAGELIST,{activityId:this.activityId}).then(function(e){e.data.forEach(function(e){t.reArrange(e)})})},muteAll:function(){var t=this,e={activityId:this.activityId,cancel:this.allMuted?"N":"Y"};this.$post(R.a.POST_GAGALL,e).then(function(i){t.$toast({content:"Y"===e.cancel?"已取消全体禁言":"已开启全体禁言"})})},initToken:function(){if(this.isWatch)return this.roomPaas},initScroll:function(){},initInfo:function(){var t=this;return c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.initSdk();case 1:case"end":return e.stop()}},e,t)}))()},loginHandler:function(){this.$emit("showLogin")},moreInfo:function(t,e){this.$emit("clickTools",{type:t,id:e})},push:function(t,e){this.$emit("magInfo",t,e)}}),watch:{"loginInfo.consumerUserId":{handler:function(t){t&&this.isWatch&&(this.isLogin=!0)},deep:!0,immediate:!0},allMuted:{handler:function(t){t?this.$emit("isMute",{isMute:!0,type:"allMuted"}):this.$emit("isMute",{isMute:!1,type:"allMuted"})},deep:!0},mute:{handler:function(t){t?this.$emit("isMute",{isMute:!0,type:"mute"}):this.$emit("isMute",{isMute:!1,type:"mute"})},deep:!0},"activityInfo.setting.gag":{handler:function(t){this.allMuted="Y"===t},deep:!0},"roomPaas.channelId":{handler:function(t){t&&(console.log(t),this.initInfo())},immediate:!0,deep:!0},"joinInfo.isGag":{handler:function(t){"Y"===t&&this.isWatch&&(this.mute=!0)},deep:!0,immediate:!0},"joinInfo.isKick":{handler:function(t){"Y"===t&&this.isWatch&&this.$router.push({path:"/kicked"})},deep:!0,immediate:!0}}},$=(i(285),Object(M.a)(Z,X,[],!1,null,"3a2ec7eb",null));$.options.__file="src/components/chat/index.vue";var tt=$.exports,et=i(214),it=i(217),at={props:{domShow:Boolean},mixins:[et.a],components:{PlayVideo:W,Chating:tt},data:function(){return{playType:"",startInit:!1,tabValue:1,isWatch:!0,chatListInit:!1,sendBoxShow:!1,isLogin:!1,isMuteShow:!1,allMuted:!1}},computed:h()({},Object(p.c)("liveMager",{activityInfo:function(t){return t.activityInfo},roomPaas:function(t){return t.roomPaas},joinInfo:function(t){return t.joinInfo}}),Object(p.c)("login",{loginInfo:function(t){return t.loginInfo}})),mounted:function(){this.storeLoginInfo(this.getLoginInfo()),this.playType="vod",this.startInit=!0,this.initMsgServe()},created:function(){},watch:{"loginInfo.consumerUserId":{handler:function(t){t&&this.isWatch&&(this.isLogin=!0)},deep:!0}},methods:h()({},Object(p.b)("login",{storeLoginInfo:U.i}),Object(p.b)("liveMager",{storeActivityInfo:U.a,storeJoinInfo:U.f}),{tabChange:function(){if(2===this.tabValue&&(this.$refs.chatbox.aBScroll||(this.$refs.chatbox.initScroll(),this.$refs.chatbox.getHistroy()),!this.$refs.chatbox.tipsShow)){var t=this;setTimeout(function(){t.$refs.chatbox.scrollBtm()},200)}},initMsgServe:function(){var t=this;K.a.OBJ.init({accountId:this.roomPaas.accountId,token:this.roomPaas.token,appId:this.roomPaas.appId,channelId:this.roomPaas.channelRoom}),K.a.OBJ.regHandler(it.a.onLineNum,function(e){var i=JSON.parse(u()(t.activityInfo));i.setting.initOnlineNum=e.num,t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.beginLive,function(e){t.playType="live";var i=JSON.parse(u()(t.activityInfo));console.log(i),i.status="LIVING",i.statusName="直播中",t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.endLive,function(e){t.playType="end";var i=JSON.parse(u()(t.activityInfo));i.status="FINISH",i.statusName="结束",t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.joinLive,function(e){console.log("--进入房间--消息--");var i=JSON.parse(u()(t.activityInfo));i.onlineNum=parseInt(i.onlineNum)+1,t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.leaveLive,function(e){console.log("--离开房间--消息--");var i=JSON.parse(u()(t.activityInfo));i.onlineNum=parseInt(i.onlineNum)-1,t.storeActivityInfo(i)})},isMute:function(t){this.isMuteShow=t.isMute,this.allMuted="allMuted"===t.type},chatClick:function(){this.sendBoxShow=!0},closeChatBox:function(){this.sendBoxShow=!1},loginSuccess:function(t){this.storeLoginInfo(t),this.isLogin=!0,this.$router.go(0)},loginHandler:function(){this.$emit("showLogin")}})},st=(i(286),Object(M.a)(at,f,[],!1,null,"3304695f",null));st.options.__file="src/pages/watch/playback.vue";var ot=st.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"v-video-box"},[a("div",{staticClass:"v-video"},[a("play-video",{attrs:{role:"watcher","play-type":t.playType,startInit:t.startInit}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.domShow,expression:"domShow"}],staticClass:"v-function-box"},[a("div",{staticClass:"v-nav"},[a("com-tabs",{attrs:{value:t.tabValue},on:{"update:value":function(e){t.tabValue=e},change:t.tabChange}},[a("com-tab",{attrs:{label:"活动简介",index:1}},[a("div",{staticClass:"v-introduction",domProps:{innerHTML:t._s(t.activityInfo.description)}})]),t._v(" "),a("com-tab",{attrs:{label:"互动聊天",index:2}},[a("div",{staticClass:"chat-content"},[a("chating",{ref:"chatbox",class:{showKeyboard:t.sendBoxShow},attrs:{type:t.playType,isWatch:t.isWatch,sendBoxShow:!0},on:{magInfo:t.magInfo,closeChatBox:t.closeChatBox,isMute:function(e){t.isMute(e)},clickTools:t.clickTools}})],1),t._v(" "),"live"!==t.playType&&"warm"!==t.playType&&"pre"!==t.playType||!t.isLogin?"live"!==t.playType&&"warm"!==t.playType&&"pre"!==t.playType||t.isLogin?t._e():[a("div",{staticClass:"v-chat-control v-noLogin",attrs:{id:"sendBoxBtn"}},[t._v("\n              需要登录才能参与聊天\n              "),a("span",{on:{click:t.doLogin}},[t._v("登录")])])]:[t.isMuteShow?[a("div",{staticClass:"v-chat-control v-noLogin",attrs:{id:"sendBoxBtn"}},[t._v("\n                "+t._s(t.allMuted?"已开启全体禁言":"您已被禁言")+"\n              ")])]:[a("div",{staticClass:"v-chat-control",attrs:{id:"sendBoxBtn"},on:{click:function(e){t.chatClick()}}},[a("i",{staticClass:"iconfont icon-biaoqing"}),t._v(" "),a("span",{staticClass:"v-chat-clickbox"},[t._v("\n                  输入文字聊天\n                ")])])]],t._v(" "),a("div",{staticClass:"msg-Box"},[a("transition",{attrs:{name:"goods-fade"}},[t.goodsSmallPopoverShow?a("div",{staticClass:"goods_small_popover"},[a("div",{on:{click:function(e){t.goInfo(t.goodsSmallDetails)}}},[a("img",{staticClass:"cover_img",attrs:{src:t.$imgHost+"/"+t.goodsSmallDetails.image[0].name}}),t._v(" "),a("div",[a("p",{staticClass:"item-price"},[a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==t.goodsSmallDetails.preferential&&"0.00"!==t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential !== '0.00' && goodsSmallDetails.price !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.preferential))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.preferential&&"0.00"!==t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential === '0.00' && goodsSmallDetails.price !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.price))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.preferential&&"0.00"===t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential === '0.00' && goodsSmallDetails.price === '0.00'"}]},[t._v("免费")]),t._v(" "),a("del",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==t.goodsSmallDetails.preferential,expression:"goodsSmallDetails.preferential !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.price))]),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.price,expression:"goodsSmallDetails.price === '0.00'"}]})]),t._v(" "),a("h4",{staticClass:"item-title"},[t._v(t._s(t.goodsSmallDetails.title))])]),t._v(" "),a("i",{staticClass:"el-icon-close",on:{click:function(e){e.stopPropagation(),t.goodsSmallPopoverShow=!1}}})]),t._v(" "),a("i")]):t._e()]),t._v(" "),a("div",{staticClass:"icon-list"},[t.downTimer?a("span",{staticClass:"redpack",on:{click:t.clickRedpack}},[a("em"),t._v("红包")]):t._e(),t._v(" "),t.questionStatus.iconShow?a("span",{staticClass:"ques",on:{click:t.clickQues}},[t.questionStatus.redIcon?a("em"):t._e(),t._v("问卷")]):t._e(),t._v(" "),t.goodsLen?a("span",{staticClass:"goods",on:{click:t.showGoods}},[a("em",[t._v(t._s(t.goodsLen))]),t._v("商品")]):t._e()]),t._v(" "),a("i")],1)],2)],1)],1),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.goodsInfoShow?a("div",{staticClass:"goodsInfo"},[a("p",[a("span",{on:{click:t.goGoodsList}},[t._v("更多商品 ")]),a("i",{staticClass:"el-icon-arrow-down",on:{click:t.closeGoods}})]),t._v(" "),a("div",[a("h4",[t._v(t._s(t.goodsSmallDetails.title))]),t._v(" "),a("el-carousel",t._l(t.goodsSmallDetails.image,function(e,i){return a("el-carousel-item",[a("img",{attrs:{src:t.$imgHost+"/"+e.name,alt:""}})])})),t._v(" "),a("p",[t._v(t._s(t.goodsSmallDetails.describe))]),t._v(" "),a("footer",[a("div",[a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==t.goodsSmallDetails.preferential&&"0.00"!==t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential !== '0.00' && goodsSmallDetails.price !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.preferential))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.preferential&&"0.00"!==t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential === '0.00' && goodsSmallDetails.price !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.price))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.preferential&&"0.00"===t.goodsSmallDetails.price,expression:"goodsSmallDetails.preferential === '0.00' && goodsSmallDetails.price === '0.00'"}]},[t._v("免费")]),t._v(" "),a("del",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==t.goodsSmallDetails.preferential,expression:"goodsSmallDetails.preferential !== '0.00'"}]},[t._v("￥"+t._s(t.goodsSmallDetails.price))]),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:"0.00"===t.goodsSmallDetails.price,expression:"goodsSmallDetails.price === '0.00'"}]})]),t._v(" "),a("span",{on:{click:function(e){t.goBuy({goods_id:t.goodsSmallDetails.goods_id,type:1})}}},[t._v("立即购买")])])],1)]):t._e()]),t._v(" "),a("transition",{attrs:{name:"fade"}},[a("comGoods",{directives:[{name:"show",rawName:"v-show",value:t.goodsListShow,expression:"goodsListShow"}],staticClass:"goodsList",attrs:{goodsMsg:t.goodsMsg},on:{closeGoodList:t.closeGoodList,goodsInfo:t.goodsInfo,goodsCount:t.goodsCount}})],1)],1),t._v(" "),t.cardData.show?a("div",{staticClass:"wrap-cover"}):t._e(),t._v(" "),a("transition",{attrs:{name:"top-bottom",mode:"out-in"}},[t.cardData.show?a("com-cards",{attrs:{cardData:t.cardData},on:{closeCards:t.closeCards}}):t._e()],1),t._v(" "),t.questionsShow?a("comQuestions",{attrs:{dragData:t.dragData,naireId:t.naireId,visitorId:t.visitorId,questions:t.questions},on:{questionSuccess:t.questionSuccess}}):t._e(),t._v(" "),t.questionsSubmissionShow?a("message-box",{staticClass:"v-questions-submission-box",attrs:{header:"",confirmText:"提交"},on:{handleClick:t.hiddenQuestions}},[a("div",{staticClass:"v-content"},[a("img",{attrs:{src:i(218),alt:""}}),t._v(" "),a("p",[t._v("已提交问卷，感谢您的参与")])])]):t._e(),t._v(" "),a("com-login",{on:{login:t.loginSuccess}}),t._v(" "),t.taoShow?a("message-box",{staticClass:"v-questions-box tao-show",attrs:{width:"100%",header:"",confirmText:""},on:{handleClick:t.taoShowBox}},[a("div",{staticClass:"v-content"},[a("img",{attrs:{src:i(287),alt:""}}),t._v(" "),a("p",[t._v("\n       请打开 "),a("br"),a("span",{staticStyle:{color:"#2878FF"}},[t._v(t._s(t.goodsSmallDetails.tao))]),t._v(" "),a("br"),t._v("购买商品\n      ")])])]):t._e()],1)};nt._withStripped=!0;var rt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cards-wrap"},[i("img",{attrs:{src:t.imgHost+"/"+t.cardData.pic}}),t._v(" "),i("div",{staticClass:"desc"},[t._v(t._s(t.cardData.desc))]),t._v(" "),"Y"===t.cardData.btn_display?i("a",{attrs:{href:t.cardData.btn_link,target:"_blank"}},[i("el-button",{staticClass:"btn primary-button",attrs:{round:""},on:{click:function(e){t.view(t.cardData.recommend_card_id)}}},[t._v(t._s(t.cardData.btn_text))])],1):t._e(),t._v(" "),i("i",{staticClass:"close",on:{click:t.close}})])};rt._withStripped=!0;var lt={data:function(){return{activityId:this.$route.params.id,imgHost:"//test-zhike.oss-cn-beijing.aliyuncs.com/"}},props:{cardData:{type:Object,default:function(){return{}}}},methods:{view:function(t){this.$get(R.a.GET_VISITED_CARD,{recommend_card_id:t,activity_id:this.activityId}).then(function(t){console.log(t)})},close:function(){this.$emit("closeCards")}}},ct=(i(288),Object(M.a)(lt,rt,[],!1,null,"965555e4",null));ct.options.__file="src/pages/watch/sales-tools/com-cards.vue";var dt=ct.exports,ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"goods-box"},[i("p",{staticClass:"header-title"},[i("span",[t._v("商品推荐 ")]),i("i",{staticClass:"el-icon-arrow-down",on:{click:t.closeGoods}})]),t._v(" "),t._l(t.goodsList,function(e,a){return i("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.added&&"1"===e.top,expression:"ite.added === '1' && ite.top === '1'"}],key:"top"+a,staticClass:"top_item",on:{click:function(i){t.goInfo({goods_id:e.goods_id,type:0})}}},[i("span",{staticClass:"index",staticStyle:{"font-size":"10px"}},[t._v("TOP")]),t._v(" "),i("div",{staticClass:"cov_img"},[i("img",{staticClass:"cover_img",attrs:{src:t.$imgHost+"/"+e.image}})]),t._v(" "),i("div",[i("h4",{staticClass:"item-title"},[t._v(t._s(e.title))]),t._v(" "),i("p",{staticClass:"item-price"},[i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==e.preferential&&"0.00"!==e.price,expression:"ite.preferential !== '0.00' && ite.price !== '0.00'"}]},[t._v("￥"+t._s(e.preferential))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.preferential&&"0.00"!==e.price,expression:"ite.preferential === '0.00' && ite.price !== '0.00'"}]},[t._v("￥"+t._s(e.price))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.preferential&&"0.00"===e.price,expression:"ite.preferential === '0.00' && ite.price === '0.00'"}]},[t._v("免费")]),t._v(" "),i("del",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==e.preferential,expression:"ite.preferential !== '0.00'"}]},[t._v("￥"+t._s(e.price))]),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.price,expression:"ite.price === '0.00'"}]})])])])}),t._v(" "),t._l(t.goodsList,function(e,a){return i("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.added&&"1"!==e.top,expression:"ite.added === '1' && ite.top !== '1'"}],staticClass:"item",on:{click:function(i){t.goInfo({goods_id:e.goods_id,type:0})}}},[i("span",{staticClass:"index"},[t._v(t._s(e.number<10?"0"+e.number:e.number)+" ")]),t._v(" "),i("div",{staticClass:"cov_img"},[i("img",{staticClass:"cover_img",attrs:{src:t.$imgHost+"/"+e.image}})]),t._v(" "),i("div",[i("h4",{staticClass:"item-title"},[t._v(t._s(e.title))]),t._v(" "),i("p",{staticClass:"item-price"},[i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==e.preferential&&"0.00"!==e.price,expression:"ite.preferential !== '0.00' && ite.price !== '0.00'"}]},[t._v("￥"+t._s(e.preferential))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.preferential&&"0.00"!==e.price,expression:"ite.preferential === '0.00' && ite.price !== '0.00'"}]},[t._v("￥"+t._s(e.price))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.preferential&&"0.00"===e.price,expression:"ite.preferential === '0.00' && ite.price === '0.00'"}]},[t._v("免费")]),t._v(" "),i("del",{directives:[{name:"show",rawName:"v-show",value:"0.00"!==e.preferential,expression:"ite.preferential !== '0.00'"}]},[t._v("￥"+t._s(e.price))]),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:"0.00"===e.price,expression:"ite.price === '0.00'"}]})])])])})],2)};ut._withStripped=!0;var vt={props:["goodsMsg"],created:function(){this.getGoodsList(),console.log(this.$route.params.id,777)},watch:{goodsMsg:{handler:function(t,e){this.setStatus(t)},immediate:!0}},data:function(){return{goodsInfo:{},buyShow:!1,goodsTopNum:0,activityId:this.$route.params.id,screenWidth:document.documentElement.clientWidth,goodsList:[],item_1:"item_1",item_2:"item_2",item_3:"item_3",item_4:"item_4"}},methods:{getGoodsList:function(){var t=this;this.$get(R.a.GET_WATCH_GOODS_LIST,{activity_id:this.activityId}).then(function(e){t.goodsTopNum=null,e.data.forEach(function(e,i){e.image&&(e.image=JSON.parse(e.image)[0].name),"1"===e.added&&(t.goodsTopNum+=1)}),t.goodsList=e.data,console.log(t.goodsList),t.$emit("goodsCount",t.goodsTopNum)})},setStatus:function(t){var e=this;console.log(t,"23456789"),this.goodsTopNum=null,this.goodsList.forEach(function(i,a){i.top="0","GOODS_ADDED"===t.type&&i.goods_id===t.goods_id?i.added=t.status:"GOODS_TOP"===t.type&&i.goods_id===t.goods_id&&(i.top=t.status),"1"===i.added&&(e.goodsTopNum+=1)}),this.$emit("goodsCount",this.goodsTopNum)},goInfo:function(t){this.buyShow=!0,this.$emit("goodsInfo",t)},closeGoods:function(){console.log("关闭"),this.$emit("closeGoodList")}}},ht=(i(289),Object(M.a)(vt,ut,[],!1,null,"1584d381",null));ht.options.__file="src/pages/watch/sales-tools/com-goods.vue";var pt=ht.exports,ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"v-questions-from"},[i("a",{staticClass:"v-close",on:{click:t.colse}},[t._v("收起"),i("i",{staticClass:"iconfont icon-Up"})]),t._v(" "),i("div",{staticClass:"v-content"},[t.defaultImg?i("img",{staticClass:"v-question-img",attrs:{src:t.defaultImg,alt:""}}):t._e(),t._v(" "),i("p",{staticClass:"v-title"},[t._v("\n      "+t._s(t.questions.title)+"\n    ")]),t._v(" "),i("p",{staticClass:"v-summary"},[t._v("\n      "+t._s(t.questions.description)+"\n    ")]),t._v(" "),i("div",{staticClass:"v-questions"},t._l(t.dragData,function(t,e){return i("com-question",{key:e,ref:"com"+e,refInFor:!0,attrs:{value:t,edit:!1,index:e+1},on:{"update:value":function(e){t=e}}})})),t._v(" "),i("button",{staticClass:"v-save",on:{click:t.save}},[t._v("提交")])])])};ft._withStripped=!0;var mt=i(212),gt=i.n(mt),yt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"single-select-wrap"},[i("div",{staticClass:"question-content"},[i("div",{staticClass:"index"},[t._v(t._s(t.index))]),t._v(" "),t.edit?i("div",{staticClass:"q-des"},[t._v(t._s(t.value.ext.name))]):t._e(),t._v(" "),i("div",{staticClass:"q-edit",class:{display:!t.edit}},[t.edit?i("com-input",{staticClass:"q-subject",class:{error:t.value.error},attrs:{"max-length":30},on:{focus:t.focusTitle},model:{value:t.value.title,callback:function(e){t.$set(t.value,"title",e)},expression:"value.title"}}):t._e(),t._v(" "),t.edit?t._e():i("div",{staticClass:"q-subject"},[t._v(t._s(t.value.title)),"Y"===t.value.required?i("span",{staticClass:"v-red"},[t._v("*")]):t._e()]),t._v(" "),i(t.QComs[t.value.type],{ref:"content",tag:"component",attrs:{edit:t.edit,isView:t.isView},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),t.edit?i("div",{staticClass:"q-operate"},[t.showAddItem?i("a",{staticClass:"add-select-item",on:{click:t.addItem}},[t._v("添加选项")]):t._e(),t._v(" "),t.value.detail&&"mobile"===t.value.detail.format?t._e():i("span",{staticClass:"required-des"},[t._v("必填")]),t._v(" "),t.value.detail&&"mobile"===t.value.detail.format?t._e():i("el-switch",{staticClass:"switch",attrs:{"inactive-color":"#DEE1FF",width:32,"active-color":"#FFD021"},model:{value:t.value.required,callback:function(e){t.$set(t.value,"required",e)},expression:"value.required"}}),t._v(" "),t.value.detail&&"mobile"===t.value.detail.format?i("span",{staticClass:"required-des"},[t._v("短信验证")]):t._e(),t._v(" "),t.value.detail&&"mobile"===t.value.detail.format?i("el-switch",{staticClass:"switch",attrs:{"inactive-color":"#DEE1FF",width:32,"active-color":"#FFD021"},model:{value:t.value.verifiy,callback:function(e){t.$set(t.value,"verifiy",e)},expression:"value.verifiy"}}):t._e(),t._v(" "),"mobile"!=t.value.detail.format?i("div",{staticClass:"sort"},[t._v("排序")]):t._e(),t._v(" "),i("div",{staticClass:"del",on:{click:t.remove}},[t._v("删除")])],1):t._e()])])};yt._withStripped=!0;var _t="radio",wt="checkbox",St="select",It={text:"q-text",date:"q-date",radio:"q-radio",checkbox:"q-checkbox",select:"q-select",area:"q-area"},Ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content"},[t._l(t.value.detail.list,function(e,a){return i("el-radio",{key:a,staticClass:"q-select-item",class:{display:!t.edit},attrs:{label:a},on:{change:t.change},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}},[t.edit?i("com-input",{class:{error:e.error},attrs:{"max-length":30},on:{focus:function(i){t.itemFocus(e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}}):t._e(),t._v(" "),t.edit?t._e():i("div",{staticClass:"item-text",domProps:{textContent:t._s(e.value)}}),t._v(" "),t.edit&&t.value.detail.list.length>1?i("span",{staticClass:"remove",on:{click:function(e){t.delItem(a)}}},[t._v("删")]):t._e()],1)}),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()],2)};Ct._withStripped=!0;var bt={props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1}},data:function(){return{val:"",errorTip:""}},methods:{delItem:function(t){this.value.detail.list.splice(t,1)},change:function(){this.errorTip=""},itemFocus:function(t){t.error&&(t.error=!1,t.value="")},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),this.value.detail.list.forEach(function(e){e.value?e.error=!1:(t=!1,e.value="请设置选项内容",e.error=!0)}),t},check:function(){if("Y"===this.value.required&&!this.val)return this.errorTip="此项为必填项",!1;var t=JSON.parse(this.value.ext);return{id:this.value.id,value:this.val,type:t.key}}}},xt=(i(290),Object(M.a)(bt,Ct,[],!1,null,"d2f19c5a",null));xt.options.__file="src/components/questionnaire/q-radio.vue";var Tt=xt.exports,kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content"},[i("el-checkbox-group",{on:{change:t.change},model:{value:t.valArr,callback:function(e){t.valArr=e},expression:"valArr"}},t._l(t.value.detail.list,function(e,a){return i("el-checkbox",{key:a,staticClass:"q-select-item",class:{display:!t.edit},attrs:{label:a}},[t.edit?i("com-input",{class:{error:e.error},attrs:{"max-length":30},on:{focus:function(i){t.itemFocus(e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}}):t._e(),t._v(" "),t.edit?t._e():i("div",{staticClass:"item-text",domProps:{textContent:t._s(e.value)}}),t._v(" "),t.edit&&t.value.detail.list.length>2?i("span",{staticClass:"remove",on:{click:function(e){t.delItem(a)}}},[t._v("删")]):t._e()],1)})),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()],1)};kt._withStripped=!0;var Bt={props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1}},data:function(){return{valArr:[],errorTip:""}},methods:{delItem:function(t){this.value.detail.list.splice(t,1)},change:function(){this.errorTip=""},itemFocus:function(t){t.error&&(t.error=!1,t.value="")},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),this.value.detail.list.forEach(function(e){e.value?e.error=!1:(t=!1,e.value="请设置选项内容",e.error=!0)}),t},check:function(){if("Y"===this.value.required&&(!this.valArr||0===this.valArr.length))return this.errorTip="此项为必填项",!1;var t=JSON.parse(this.value.ext),e="";return this.valArr&&(1===this.valArr.length?e=this.valArr[0]:this.valArr.length>1&&(e=this.valArr.join(","))),{id:this.value.id,value:e,type:t.key}}}},Dt=(i(291),Object(M.a)(Bt,kt,[],!1,null,"4ba69c1b",null));Dt.options.__file="src/components/questionnaire/q-checkbox.vue";var At=Dt.exports,Pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content",class:{display:!t.edit}},[t._l(t.value.detail.list,function(e,a){return t.edit?i("div",{key:a,staticClass:"q-select-item",attrs:{label:a}},[i("span",{staticClass:"select-icon"},[t._v("√")]),t._v(" "),i("div",{staticClass:"select-input"},[i("com-input",{class:{error:e.error},attrs:{disabled:!!t.value.ext.fixedness,"max-length":t.value.ext.fixedness?0:30},on:{focus:function(i){t.itemFocus(e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}}),t._v(" "),t.value.detail.list.length>1&&!t.value.ext.fixedness?i("span",{staticClass:"remove",on:{click:function(e){t.delItem(a)}}},[t._v("删")]):t._e()],1)]):t._e()}),t._v(" "),t.edit?t._e():i("el-select",{attrs:{placeholder:"请选择"},on:{change:t.change},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}},t._l(t.value.detail.list,function(t,e){return i("el-option",{key:e,attrs:{label:t.value,value:t.key}})})),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()],2)};Pt._withStripped=!0;var Lt={props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1}},data:function(){return{val:"",errorTip:""}},methods:{delItem:function(t){this.value.detail.list.splice(t,1)},change:function(){this.errorTip=""},itemFocus:function(t){t.error&&(t.error=!1,t.value="")},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),this.value.detail.list.forEach(function(e){e.value?e.error=!1:(t=!1,e.value="请设置选项内容",e.error=!0)}),t},check:function(){if("Y"===this.value.required&&!this.val)return this.errorTip="此项为必填项",!1;var t=JSON.parse(this.value.ext);return{id:this.value.id,value:this.val,type:t.key,list:this.value.detail.list}}}},Ot=(i(292),Object(M.a)(Lt,Pt,[],!1,null,"4b2b7e58",null));Ot.options.__file="src/components/questionnaire/q-select.vue";var qt=Ot.exports,Et=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content"},[t.edit?t._e():i("com-input",{attrs:{disabled:t.isHidden,type:"phone"===t.value.detail.format?"mobile":t.value.detail.format,"max-length":t.value.detail.max?t.value.detail.max:0,value:t.value.value},on:{focus:t.focus,"update:value":function(e){t.$set(t.value,"value",e)}}}),t._v(" "),t.edit||"Y"!==t.value.verification||t.isHidden?t._e():i("div",{staticClass:"captcha",attrs:{id:t.captchaId}}),t._v(" "),t.edit||"Y"!==t.value.verification||t.isHidden?t._e():i("com-input",{staticClass:"code",attrs:{local:!0,"max-length":6,type:"number",placeholder:"请输入验证码"},on:{focus:t.focus},model:{value:t.value.code,callback:function(e){t.$set(t.value,"code",e)},expression:"value.code"}}),t._v(" "),t.edit||"Y"!==t.value.verification||t.isHidden?t._e():i("com-button",{staticClass:"codeBtn",attrs:{disabled:!t.codeEnable},on:{click:t.getCode}},[t._v(t._s(t.codeText))]),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()],1)};Et._withStripped=!0;var Nt={mixins:[et.a],props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1},isView:{type:Boolean,default:!1}},data:function(){return{captchaId:"ca"+Math.round(1e3*Math.random()),time:60,captchaIns:null,captchaKey:"",key:null,verify:!1,mobileReg:/^1[1|2|3|4|5|6|7|8|9][0-9]\d{8}$/,errorTip:"",phoneKey:"",codeType:"CONSUMER_USER_LOGIN",isHidden:!1}},mounted:function(){var t=this;if("phone"===this.value.detail.format){var e=JSON.parse(sessionStorage.getItem("login"));e?(this.value.value=e.mobile,this.isHidden=!0):this.$get(R.a.GET_CAPTCHAID).then(function(e){t.key=e.data,window.initNECaptcha({element:"#"+t.captchaId,width:"100%",captchaId:t.key,onVerify:function(e,i){e?console.log(e):(t.verify=!0,t.captchaKey=i.validate)}},function(e){t.captchaIns=e},function(t){console.log(t)})})}},computed:{codeText:function(){return this.codeEnable||60===this.time?"发送验证码":"倒计时"+this.time+"秒"},codeEnable:function(){return this.mobileReg.test(this.value.value)&&this.verify&&60===this.time}},methods:{getCode:function(){var t=this;if(!this.verification(this.value.value,"phone"))return!1;this.$config({handlers:!0}).$get(R.a.GET_CODE,{mobile:this.value.value,type:"CONSUMER_USER_LOGIN",captcha:this.captchaKey,__errHandler:!0}).then(function(e){t.time--,t.timer=setInterval(function(){t.time--,0===t.time&&(clearInterval(t.timer),t.time=60)},1e3),console.log(e)})},verification:function(t,e){return"phone"===e?!!/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(t)||(this.errorTip="请正确填写手机号",!1):"code"===e?!!/^\d{6}$/.test(t)||(this.errorTip="请输入正确验证码",!1):void 0},focus:function(){this.errorTip=""},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),t},check:function(){if("Y"===this.value.required&&!this.value.value&&"phone"!==this.value.detail.format)return this.errorTip="此项为必填项",!1;if("email"===this.value.detail.format&&this.value.value){if(!/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(this.value.value))return this.errorTip="请输入正确的邮箱格式",!1}else if("phone"===this.value.detail.format){if(!this.value.value||this.value.value.length<11)return this.errorTip="请输入正确的手机号",!1;if(!this.isHidden&&!this.value.code&&"Y"===this.value.verification)return this.errorTip="请输入验证码",!1;if(!this.verification(this.value.value,"phone"))return!1;if(!this.isHidden&&!this.verification(this.value.code,"code"))return!1;var t=JSON.parse(this.value.ext);return{id:this.value.id,value:this.value.value,code:this.isHidden?"":this.value.code,type:t.key}}var e=JSON.parse(this.value.ext);return{id:this.value.id,value:this.value.value,type:e.key}}}},Vt=(i(293),Object(M.a)(Nt,Et,[],!1,null,"3630a085",null));Vt.options.__file="src/components/questionnaire/q-text.vue";var jt=Vt.exports,Mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content"},[t.edit?t._e():i("el-date-picker",{attrs:{type:"date",editable:!1,"value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":t.pickerOptions},on:{focus:t.focus},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}}),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()],1)};Mt._withStripped=!0;var Ht={props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1}},data:function(){return{val:"",errorTip:"",pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}}}},methods:{focus:function(){this.errorTip=""},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),t},check:function(){if("Y"===this.value.required&&!this.val)return this.errorTip="此项为必填项",!1;var t=JSON.parse(this.value.ext);return{id:this.value.id,value:this.val,type:t.key}}}},Gt=(i(294),Object(M.a)(Ht,Mt,[],!1,null,"4643baf4",null));Gt.options.__file="src/components/questionnaire/q-date.vue";var Ut=Gt.exports,Rt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"q-edit-content"},[i("div",{staticClass:"q-edit-select"},[i("el-select",{attrs:{placeholder:"省/自治区/直辖市"},on:{change:t.changeProvince,focus:t.focusProvince},model:{value:t.provinceVal,callback:function(e){t.provinceVal=e},expression:"provinceVal"}},t._l(t.provinces,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("div",{staticClass:"q-edit-select"},[i("el-select",{attrs:{placeholder:"市"},on:{change:t.changeCity,focus:t.focusCity},model:{value:t.cityVal,callback:function(e){t.cityVal=e},expression:"cityVal"}},t._l(t.cities,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),t.edit||!t.edit&&("county"===this.value.detail.level||"address"===this.value.detail.level)?i("div",{staticClass:"q-edit-select"},[i("el-select",{attrs:{placeholder:"区/县"},on:{change:t.changeCounty,focus:t.focusCounty},model:{value:t.countyVal,callback:function(e){t.countyVal=e},expression:"countyVal"}},t._l(t.counties,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),t._v(" "),t.edit?i("span",{staticClass:"remove",on:{click:function(e){t.setLevel("county")}}},[t._v(t._s(t.getCountyState))]):t._e()],1):t._e(),t._v(" "),t.edit||!t.edit&&"address"===this.value.detail.level?i("div",{staticClass:"q-edit-select"},[i("com-input",{attrs:{placeholder:"详细地址",disabled:t.edit,"max-length":50},on:{focus:t.focusAddress},model:{value:t.addressVal,callback:function(e){t.addressVal=e},expression:"addressVal"}}),t._v(" "),t.edit?i("span",{staticClass:"remove",on:{click:function(e){t.setLevel("address")}}},[t._v(t._s(t.getAddressState))]):t._e()],1):t._e(),t._v(" "),!t.edit&&t.errorTip?i("div",{staticClass:"error-msg"},[t._v(t._s(t.errorTip)+"\n  ")]):t._e()])};Rt._withStripped=!0;var zt="https://static.vhallyun.com/public/static/js/area.json",Jt="/frontend/tool/get-naire",Ft="/frontend/tool/commit-answer",Wt={props:{value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1}},data:function(){return{provinceVal:"",cityVal:"",countyVal:"",addressVal:"",area:{},province:"",city:"",county:"",provinces:[],cities:[],counties:[],errorTip:""}},mounted:function(){var t=this;this.$get(zt).then(function(e){t.area=e,t.provinces=t.area.provinces})},methods:{setLevel:function(t){"address"===t&&this.value.detail.level===t?this.value.detail.level="county":"county"!==t||this.value.detail.level!==t&&"address"!==this.value.detail.level?this.value.detail.level=t:this.value.detail.level="city"},changeProvince:function(t){this.cities=this.area.cities[t],this.cityVal="",this.countyVal=""},focusProvince:function(){this.errorTip=""},blurProvince:function(){var t=this;setTimeout(function(){"Y"!==t.value.required||t.value.province||(t.errorTip="此项为必填项")},300)},changeCity:function(t){this.counties=this.area.counties[t],this.countyVal=""},focusCity:function(){this.errorTip=""},blurCity:function(){var t=this;setTimeout(function(){"Y"!==t.value.required||t.value.city||(t.errorTip="此项为必填项")},300)},changeCounty:function(){},focusCounty:function(){this.errorTip=""},blurCounty:function(){var t=this;setTimeout(function(){"Y"!==t.value.required||t.value.county||(t.errorTip="此项为必填项")},300)},focusAddress:function(){this.errorTip=""},blurAddress:function(){"Y"!==this.value.required||this.value.address||(this.errorTip="此项为必填项")},validate:function(){var t=!0;return this.value.title||(t=!1,this.value.error=!0,this.value.title="请设置问卷内容"),t},check:function(){var t=this,e=[];if(!("Y"!==this.value.required||this.provinceVal&&this.cityVal))return this.errorTip="此项为必填项",!1;if(this.provinceVal&&this.provinces.forEach(function(i){i.value===t.provinceVal&&e.push(i.label)}),this.cityVal&&this.cities.forEach(function(i){i.value===t.cityVal&&e.push(i.label)}),"Y"===this.value.required&&("county"===this.value.detail.level||"address"===this.value.detail.level)&&!this.countyVal)return this.errorTip="此项为必填项",!1;if(this.countyVal&&this.counties.forEach(function(i){i.value===t.countyVal&&e.push(i.label)}),"Y"===this.value.required&&"address"===this.value.detail.level&&!this.addressVal)return this.errorTip="此项为必填项",!1;this.addressVal&&e.push(this.addressVal);var i=JSON.parse(this.value.ext);return{id:this.value.id,value:e.join("|"),type:i.key}}},computed:{getCountyState:function(){return"county"===this.value.detail.level||"address"===this.value.detail.level?"隐":"显"},getAddressState:function(){return"address"===this.value.detail.level?"隐":"显"}}},Xt=(i(295),Object(M.a)(Wt,Rt,[],!1,null,"0eb37be5",null));Xt.options.__file="src/components/questionnaire/q-area.vue";var Yt={components:{qRadio:Tt,qCheckbox:At,qSelect:qt,qText:jt,qDate:Ut,qArea:Xt.exports},props:{index:{type:Number,default:1},value:{type:Object,default:function(){return{}}},edit:{type:Boolean,default:!1},isView:{type:Boolean,default:!1}},data:function(){return{QComs:It}},mounted:function(){"Y"===this.value.verification&&(this.value.verifiy=!0)},methods:{check:function(){return this.$refs.content.check()},focusTitle:function(){this.value.error&&(this.value.error=!1,this.value.title="")},addItem:function(){this.value.detail.list.length<20&&this.value.detail.list.push({value:"选项"})},remove:function(){var t={type:this.value.ext.key,index:this.index};this.$emit("remove",t)}},watch:{"value.verifiy":{handler:function(t){this.value.verification=t?"Y":"N"},deep:!0}},computed:{showAddItem:function(){return!this.value.ext.fixedness&&(this.value.type===_t||this.value.type===wt||this.value.type===St)}}},Qt=(i(296),Object(M.a)(Yt,yt,[],!1,null,"d1ee2774",null));Qt.options.__file="src/components/questionnaire/wrap.vue";var Kt={components:{comQuestion:Qt.exports},mixins:[et.a],props:{dragData:{type:Array,default:null},naireId:{type:Number,default:null},visitorId:{type:String,default:null},questions:{type:Object,default:null}},data:function(){return{activityId:this.$route.params.id,imgHost:"//test-zhike.oss-cn-beijing.aliyuncs.com/"}},computed:{defaultImg:function(){return this.questions.imgUrl?this.$imgHost+"/"+this.questions.imgUrl:""}},methods:{save:function(){var t=this,e=!0,i=this.$refs,a={},s=!1;a.activityId=this.$route.params.id,a.naireId=this.naireId,a.visitorId=this.visitorId,a.extData={},a.extData.wechat_auth=this.getAuthInfo(),a.naireData={},gt()(i).forEach(function(t){if(e){var o=i[t][0].check();if(o)switch(a.naireData[o.id]=o.value,o.type){case"phone":a.extData.phone=o.value,a.extData.verifyCode=o.code?o.code:"",s=o.code;break;case"name":a.extData.real_name=o.value;break;case"edu":o.list.forEach(function(t){o.value===t.key&&(a.extData.education_level=t.value)});break;case"birth":a.extData.birthday=o.value;break;case"area":a.extData.address=o.value;break;case"sex":o.list.forEach(function(t){o.value===t.key&&(a.extData[o.type]="男"===t.value?"M":"W")});break;case"industry":o.list.forEach(function(t){o.value===t.key&&(a.extData[o.type]=t.value)});break;case"email":case"position":a.extData[o.type]=o.value}else e=!1}}),e&&(a.extData=u()(a.extData),a.naireData=u()(a.naireData),this.$config({handlers:!0}).$post(Ft,a).then(function(e){z.a.$emit("red_packet"),t.$toast({content:"提交成功",position:"center"}),s?setTimeout(function(){t.$router.go(0)},1e3):t.$emit("questionSuccess",!1)}).catch(function(e){if(10020===e.code){var i=t.$refs;i["com"+(gt()(i).length-1)][0].$refs.content.errorTip="验证码不正确"}else 15110===e.code?(t.$emit("questionSuccess",!1),t.$toast({content:e.msg,position:"center"}),s&&setTimeout(function(){t.$router.go(0)},1e3)):t.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})}))},colse:function(){this.$emit("questionSuccess",!0)}}},Zt=(i(297),Object(M.a)(Kt,ft,[],!1,null,"5e6c2878",null));Zt.options.__file="src/pages/watch/sales-tools/com-questions.vue";var $t=Zt.exports,te={props:{domShow:Boolean},mixins:[et.a],components:{PlayVideo:W,Chating:tt,comCards:dt,comQuestions:$t,comGoods:pt},data:function(){return{playType:"",startInit:!1,tabValue:1,isWatch:!0,chatListInit:!1,sendBoxShow:!1,isLogin:!1,isMuteShow:!1,allMuted:!1,cardData:{show:!1,btn_display:"Y",btn_link:"www.baidu.com",btn_text:"地方的",desc:"打手犯规负担",pic:"mp-test/9c/10/9c10d12e6f417d6bd29a911159420290.png",push_num:"0",recommend_card_id:"18",title:"v风格方法",view_num:"0",visit_num:"0"},dragData:[],questionsShow:!1,questionsSubmissionShow:!1,naireId:"",questions:{imgUrl:"",title:"",description:""},visitorId:this.$parent.sdkVisitorId,currentQuestionId:"",questionShow:!1,questionStatus:{iconShow:!1,redIcon:!1},goodsSmallPopoverShow:!1,goodsSmallDetails:{},goodsMsg:{},goodsInfoShow:!1,goodsListShow:!1,activityId:this.$route.params.id,taoShow:!1,goodsLen:0}},computed:h()({},Object(p.c)("liveMager",{activityInfo:function(t){return t.activityInfo},roomPaas:function(t){return t.roomPaas},joinInfo:function(t){return t.joinInfo},downTimer:function(t){return t.downTimer}}),Object(p.c)("login",{loginInfo:function(t){return t.loginInfo}})),mounted:function(){this.storeLoginInfo(this.getLoginInfo()),"PREPARE"===this.activityInfo.status?this.activityInfo.warm&&"Y"===this.activityInfo.warm.enabled?this.playType="warm":this.playType="pre":"FINISH"===this.activityInfo.status?this.playType="end":this.playType="live",this.startInit=!0,this.initMsgServe(),this.getQuestionsStatus()},created:function(){},watch:{"loginInfo.consumerUserId":{handler:function(t){t&&this.isWatch&&(this.isLogin=!0)},deep:!0}},methods:h()({},Object(p.b)("login",{storeLoginInfo:U.i}),Object(p.b)("liveMager",{storeActivityInfo:U.a,storeJoinInfo:U.f}),{tabChange:function(){if(2===this.tabValue&&!this.$refs.chatbox.tipsShow){var t=this;setTimeout(function(){t.$refs.chatbox.scrollBottom(10)},200)}},initMsgServe:function(){var t=this;K.a.OBJ.init({accountId:this.roomPaas.accountId,token:this.roomPaas.token,appId:this.roomPaas.appId,channelId:this.roomPaas.channelRoom}),K.a.OBJ.regHandler(it.a.onLineNum,function(e){var i=JSON.parse(u()(t.activityInfo));i.setting.initOnlineNum=e.num,t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.beginLive,function(e){setTimeout(function(){t.playType="live";var e=JSON.parse(u()(t.activityInfo));console.log(e),e.status="LIVING",e.statusName="直播中",t.storeActivityInfo(e)},15e3)}),K.a.OBJ.regHandler(it.a.endLive,function(e){setTimeout(function(){t.playType="end";var e=JSON.parse(u()(t.activityInfo));e.status="FINISH",e.statusName="结束",t.storeActivityInfo(e),_log.track(Vhall_User_Actions.LEAVE)},15e3)}),K.a.OBJ.regHandler(it.a.joinLive,function(e){console.log("--进入房间--消息--");var i=JSON.parse(u()(t.activityInfo));i.onlineNum=parseInt(i.onlineNum)+1,t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.leaveLive,function(e){console.log("--离开房间--消息--");var i=JSON.parse(u()(t.activityInfo));t.allMuted&&(i.setting.gag=t.isMuteShow?"Y":"N"),i.onlineNum=parseInt(i.onlineNum)-1,console.log(i),t.storeActivityInfo(i)}),K.a.OBJ.regHandler(it.a.MARKET_TOOL,function(e){switch(console.log(e),e.type){case"RECOMMEND_CARD_PUSH":console.log("--推荐卡片--消息--"),t.getCardDetails(e.recommend_card_id);break;case"NAIRE":console.log("--发送问卷--消息--"),t.currentQuestionId===e.id&&t.questionsShow||(t.currentQuestionId=e.id,t.getQuestions(e.id));break;case"GOODS_PUSH":console.log("--商品推送--消息--"),t.getGoodsDetails(e.goods_id);break;case"GOODS_ADDED":case"GOODS_TOP":console.log("--商品上架--消息--"),t.goodsMsg=e}})},isMute:function(t){this.isMuteShow=t.isMute,this.allMuted="allMuted"===t.type},chatClick:function(){this.sendBoxShow=!0,document.getElementsByClassName("inp")[0].children[0].focus()},closeChatBox:function(){this.sendBoxShow=!1},loginSuccess:function(t){this.storeLoginInfo(t),this.isLogin=!0,this.$router.go(0)},loginHandler:function(){this.$emit("showLogin")},closeCards:function(){this.cardData.show=!1},getQuestionsStatus:function(){var t=this;this.$config({handlers:!0}).$get(Jt,{activityId:this.$route.params.id,visitorId:this.visitorId}).then(function(e){200===e.code&&e.data&&e.data.id&&(t.questionStatus.iconShow=!0,t.questionStatus.redIcon=!0)}).catch(function(e){15110===e.code&&(t.questionStatus.iconShow=!0,t.questionStatus.redIcon=!1)})},getQuestions:function(){var t=this;this.questionsShow=!1,this.questionsSubmissionShow=!1,this.$config({handlers:!0}).$get(Jt,{activityId:this.$route.params.id,visitorId:this.visitorId}).then(function(e){t.questionStatus.redIcon=!0,t.questions.imgUrl=e.data.imgUrl,t.questions.title=e.data.title,t.questions.description=e.data.description,t.naireId=e.data.id,t.dragData=e.data.detail,t.questionsShow=!0}).catch(function(e){15110===e.code?(t.questionsSubmissionShow=!0,t.questionStatus.iconShow=!0,t.questionStatus.redIcon=!1):t.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})})},questionSuccess:function(t){this.questionsShow=!1,this.questionStatus.redIcon=t},hiddenQuestions:function(t){"cancel"===t.action&&(this.questionsSubmissionShow=!1)},getCardDetails:function(t){var e=this;this.$get(R.a.GET_VISITED_CARD_DETAIL,{recommend_card_id:t}).then(function(t){if(200===t.code){e.cardData=h()({},t.data,{show:!0}),console.log(e.cardData)}})},clickTools:function(t){},getGoodsDetails:function(t,e){var i=this;this.$get(R.a.GET_WATCH_GOODS_DETAIL,{goods_id:t}).then(function(t){200===t.code&&(e||(i.goodsSmallPopoverShow=!0),t.data.image=JSON.parse(t.data.image),i.goodsSmallDetails=t.data,console.log(i.goodsSmallDetails,8888))})},magInfo:function(t,e){"GOODS_PUSH"===t&&console.log(t,e,"555555")},closeGoods:function(){this.goodsInfoShow=!1},showGoods:function(){this.goodsListShow=!0},closeGoodList:function(){this.goodsListShow=!1},goodsInfo:function(t){var e=this;return c()(r.a.mark(function i(){return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e.goodsListShow=!1,e.goodsInfoShow=!0,i.next=4,e.getGoodsDetails(t.goods_id,"info");case 4:return i.next=6,e.goodsVisit(t);case 6:case"end":return i.stop()}},i,e)}))()},goInfo:function(t){var e=this;return c()(r.a.mark(function i(){return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e.goodsInfoShow=!0,e.goodsSmallPopoverShow=!1,i.next=4,e.getGoodsDetails(t.goods_id,"info");case 4:return i.next=6,e.goodsVisit({goods_id:t.goods_id,type:0});case 6:case"end":return i.stop()}},i,e)}))()},goBuy:function(t){this.goodsVisit(t),this.goodsSmallDetails.tao?this.taoShow=!0:location.href=this.goodsSmallDetails.url},taoShowBox:function(t){"cancel"===t.action?this.taoShow=!1:t.action},goodsCount:function(t){this.goodsLen=t},clickRedpack:function(){this.$parent.showDownTip()},goGoodsList:function(){this.goodsInfoShow=!1,this.goodsListShow=!0},clickQues:function(){this.getQuestions()},goodsVisit:function(t){t.activity_id=this.activityId,this.$get(R.a.GOODS_VISIT,t)}})},ee=(i(298),Object(M.a)(te,nt,[],!1,null,"8c492ca0",null));ee.options.__file="src/pages/watch/live.vue";var ie=ee.exports,ae=function(){var t=this.$createElement;return(this._self._c||t)("div")};ae._withStripped=!0;var se={name:"empty"},oe=Object(M.a)(se,ae,[],!1,null,null,null);oe.options.__file="src/pages/watch/empty.vue";var ne=oe.exports,re=i(219),le=i(73),ce=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.rainTime?i("div",{staticClass:"red-bag-rain"},[i("span",{staticClass:"rain-num"},[i("img",{attrs:{src:t.imageData}}),t._v(" "),i("span",[t._v(t._s(t.selectBagList.length))])]),t._v(" "),i("span",{staticClass:"rain-time"},[t._v("剩余时间　"+t._s(t.redBagTimer))]),t._v(" "),t._l(t.redBagList,function(e,a){return i("img",{staticClass:"red-bag-item",style:{animationDuration:e.speed+"s",transform:"translate3d(0,0,0) rotate("+e.rotate+"deg) scale("+e.scale+")",left:e.left+"px",top:e.top+"px"},attrs:{src:t.imageData},on:{click:function(e){t.selectRed(a,e)}}})}),t._v(" "),t._l(t.jinbiList,function(t){return i("span",{staticClass:"jinbi",style:{animationDuration:t.speed+"s",transform:"translate3d(0,0,0) rotate("+t.rotate+"deg) scale("+t.scale+")",left:t.left+"px",top:t.top+"px"}})}),t._v(" "),t._l(t.meteorList,function(e){return i("svg",{staticClass:"meteor",style:{transform:"scale("+e.scale+")",left:e.left+"px",top:e.top+"px"},attrs:{width:"176px",height:"296px",viewBox:"0 0 176 296",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("defs",[i("linearGradient",{attrs:{x1:"117.16338%",y1:"50%",x2:"0%",y2:"50%",id:"linearGradient-1"}},[i("stop",{attrs:{"stop-color":"#FF6700","stop-opacity":"0",offset:"0%"}}),t._v(" "),i("stop",{attrs:{"stop-color":"#FE0025",offset:"100%"}})],1)],1),t._v(" "),i("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd",opacity:"0.699999988"}},[i("g",{attrs:{transform:"translate(-33.000000, -270.000000)",fill:"url(#linearGradient-1)"}},[i("g",{attrs:{transform:"translate(-38.000000, -129.000000)"}},[i("rect",{attrs:{id:"Rectangle-6-Copy-3",transform:"translate(159.196699, 546.975920) rotate(-60.000000) translate(-159.196699, -546.975920) ",x:"-9.30330086",y:"542.97592",width:"337",height:"8"}})])])])])}),t._v(" "),t._l(t.bigMeteorList,function(e){return i("svg",{staticClass:"meteor",style:{transform:"scale("+e.scale+")",left:e.left+"px",top:e.top+"px"},attrs:{width:"181px",height:"312px",viewBox:"0 0 181 312",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("defs",[i("linearGradient",{attrs:{x1:"106.792283%",y1:"50%",x2:"0%",y2:"50%",id:"linearGradient-1"}},[i("stop",{attrs:{"stop-color":"#FF6700","stop-opacity":"0",offset:"0%"}}),t._v(" "),i("stop",{attrs:{"stop-color":"#FE0025",offset:"100%"}})],1)],1),t._v(" "),i("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd",opacity:"0.699999988"}},[i("g",{attrs:{transform:"translate(-158.000000, -92.000000)",fill:"url(#linearGradient-1)"}},[i("g",{attrs:{transform:"translate(-38.000000, -129.000000)"}},[i("rect",{attrs:{id:"Rectangle-6-Copy-4",opacity:"0.803292411",transform:"translate(286.500000, 377.279221) rotate(-60.000000) translate(-286.500000, -377.279221) ",x:"107",y:"376.779221",width:"359",height:"1"}})])])])])})],2):t._e()};ce._withStripped=!0;var de={name:"red-bag-rain",data:function(){return{redBagList:[],jinbiList:[],selectBagList:[],meteorList:[],bigMeteorList:[],redBagTime:0,imageData:"data:image/png;base64,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"}},props:{rainTime:{type:Number,default:0},density:{type:Number,default:.5}},computed:{redBagTimer:function(){return((this.redBagTime/60%60>>0)+"").padStart(2,0)+":"+((this.redBagTime%60>>0)+"").padStart(2,0)}},watch:{rainTime:function(t){t?(this.redBagTime=t,this.dealWithRain()):(this.redBagList=[],this.jinbiList=[],this.meteorList=[],this.bigMeteorList=[],this.selectBagList=[])},density:{handler:function(t){(t>=0||t<=1)&&console.warn("The density ranges from 0 to 1.")},immediate:!0}},methods:{random:function(t,e){return t=t||0,e=e||100,Math.round(Math.random()*(e-t))+t},dealWithRain:function(){var t=this;this.redBagList=[],this.jinbiList=[],this.meteorList=[],this.bigMeteorList=[],this.selectBagList=[];for(var e=document.body.clientWidth,i=document.body.clientHeight,a=!1,s=0;s<100*this.density;s++)a=!a,this.redBagList.push({uuid:"uuid_"+Math.random(),rotate:a?this.random(0,30):-this.random(0,30),speed:this.random(6,10),left:this.random(0,e-60),top:2*-this.random(0,i),scale:this.random(5,7)/10});for(var o=0;o<20*this.density;o++)this.jinbiList.push({rotate:this.random(0,180),speed:this.random(6,10),left:this.random(0,e-60),top:2*-this.random(0,i),scale:this.random(5,8)/10});for(var n=0;n<20*this.density;n++)this.meteorList.push({left:this.random(0,e-50),top:this.random(0,i),scale:this.random(5,8)/10}),this.bigMeteorList.push({left:this.random(0,e-50),top:this.random(0,i),scale:this.random(5,8)/10});this.$nextTick(function(){var e=setInterval(function(){if(0===t.redBagTime)return clearInterval(e),void t.$emit("endRain",t.selectBagList.length);t.redBagTime=t.redBagTime-1},1e3)})},selectRed:function(t,e){var i=this,a=this.redBagList[t];this.selectBagList.push(a.uuid),this.$emit("selectOk",this.selectBagList.length),e.target.setAttribute("class","red-bag-item hidden-red");var s=setTimeout(function(){clearTimeout(s),i.redBagList.splice(t,1)},2e3)}}},ue=(i(299),Object(M.a)(de,ce,[],!1,null,"18553439",null));ue.options.__file="src/pages/watch/red-bag-rain.vue";var ve=ue.exports,he="MARKET_TOOL",pe="RED_PACKET_PUSH",fe={PREPARE:"pre",LIVING:"live",FINISH:"end",PLAYBACK:"vod"},me={PREPARE:"预告",LIVING:"直播中",FINISH:"结束",PLAYBACK:"回放"},ge={mixins:[et.a],components:{RedBagRain:ve},data:function(){return{MOBILE_HOST:"//test-zhike.vhall.com/m/",activityId:"",companyName:"",playType:"",playStatus:"",imgUrl:"",currentView:ne,vhallParams:{token:"",appId:"",channelId:"",accountId:""},subscribeShow:!1,businessUserId:"",domShow:!0,autoClose:0,email:"",errorTips:"",successShow:!1,isShowSite:"",wxShare:{wxShareData:{appId:"",timestamp:"",nonceStr:"",signature:""},shareData:{title:"",shareDatadesc:"",shareDatalink:"",shareDataimgUrl:""},shareUser:{shareId:""}},vx5div:!1,vclosex5div:!1,votherdiv:!1,showPersonCount:0,sdkVisitorId:"",logoImg:"",red_packet_id:"",redBagTipShow:!1,redBagNoneShow:!1,redBagShow:!1,redBagTimeDownShow:!1,redBagrecordList:[],redBagResultInfo:{avatar:"",nick_name:"",amount:"",amount_ranking:"",percent:""},autoTime:0,rainTime:0,redBagCount:0,timer:10,timerInterval:0,redBagStartTimer:0,redBagStartTimerInterval:0}},mounted:function(){this.storeLoginInfo(this.getLoginInfo()),this.loginInfo||this.doLogin()},computed:h()({},Object(p.c)("liveMager",{activityInfo:function(t){return t.activityInfo},joinInfo:function(t){return t.joinInfo},roomPaas:function(t){return t.roomPaas},downTimer:function(t){return t.downTimer}}),Object(p.c)("tokenMager",{chatParams:function(t){return t.chatParams}}),Object(p.c)("login",{loginInfo:function(t){return t.loginInfo}}),{activityStatus:function(){return this.activityInfo.statusName},defaultImg:function(){return this.imgUrl?this.$imgHost+"/"+this.imgUrl:""},customLogo:function(){var t=this.logoImg;return t?this.$imgHost+"/"+t:""}}),beforeDestroy:function(){clearInterval(this.timerInterval),clearInterval(this.redBagStartTimerInterval)},created:function(){var t=this;this.PlaybackVideo(),z.a.$on("enterFullScreen",function(){t.vx5div=!0,t.vclosex5div=!1}),z.a.$on("exitFullScreen",function(){t.vx5div=!1,t.vclosex5div=!0});var e=this.$route.params.id;e||this.$router.go(-1),this.activityId=e,this.initPage(),z.a.$on("red_packet",function(e){if(t.red_packet_id){var i={red_packet_id:t.red_packet_id,activity_id:t.activityId};e&&(i.password=e),t.$config({handlers:!0}).$post(R.a.UNLOCK_RED_BAG,i).then(function(t){}).catch(function(t){console.log(t)})}});var i=this;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){90===window.orientation||-90===window.orientation?(i.votherdiv=!0,i.domShow=!1):(i.votherdiv=!1,i.domShow=!0)},!1)},filters:{fmtTimer:function(t){return((t/60%60>>0)+"").padStart(2,0)+":"+((t%60>>0)+"").padStart(2,0)}},watch:{activityInfo:{handler:function(t){t&&t.setting&&(this.showPersonCount=parseInt(t.setting.initOnlineNum?t.setting.initOnlineNum:0)+parseInt(t.onlineNum?t.onlineNum:0))},deep:!0,immediate:!0},redBagTimeDownShow:function(t){var e=this;t&&(this.timer=10,this.timerInterval=setInterval(function(){if(0===e.timer)return clearInterval(e.timerInterval),e.timerInterval=0,e.redBagTimeDownShow=!1,void(e.rainTime=10);e.timer--},1e3))}},methods:h()({},Object(p.b)("tokenMager",{setChatParams:U.c}),Object(p.b)("liveMager",{storeActivityInfo:U.a,storeRoomPaas:U.j,storeJoinInfo:U.f,storeDownTimer:U.d}),Object(p.b)("login",{storeLoginInfo:U.i}),{subscribe:function(){this.loginInfo?this.loginInfo.email?this.sendSubScribe():this.subscribeShow=!0:this.doLogin()},emailFocus:function(){this.errorTips=""},isX5:function(){var t=navigator.userAgent;return!(!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||!t.match(/MicroMessenger/i)&&!t.match(/QQ/i))},sendSubScribe:function(){var t=this;this.$config({handlers:!0}).$post(R.a.POST_EMAILSUBSCRIBE,{activityId:this.$route.params.id,email:this.loginInfo.email?this.loginInfo.email:this.email}).then(function(e){t.autoClose=3,t.subscribeShow=!1,t.successShow=!0;var i=JSON.parse(u()(t.loginInfo));i.email=t.email,t.updateLoginInfo(i),t.storeLoginInfo(i)}).catch(function(e){t.subscribeShow=!1,t.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})})},subscribeClick:function(t){if("cancel"===t.action)this.subscribeShow=!1;else if("confirm"===t.action){if(""===this.email)return this.errorTips="请输入邮箱",!1;if(this.email&&!/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(this.email))return this.errorTips="邮箱格式不正确",!1;this.errorTips="",this.sendSubScribe()}},successClick:function(t){"cancel"===t.action?this.successShow=!1:"confirm"===t.action&&(this.successShow=!1)},initPage:function(){var t=this;return c()(r.a.mark(function e(){var i,a,s,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$config({handlers:!0}).$post(le.a.GET_VISITOR_INFO,{wechatAuth:sessionStorage.getItem("wechatAuth")}).then(function(e){_log.set("visitor_id",e.data.visitorId),t.sdkVisitorId=e.data.visitorId});case 2:return e.next=4,t.initRoomPaas();case 4:return t.initMsgServe(),t.isWx()&&setTimeout(function(){t.share()},1e3),i=null,a=null,e.next=10,t.$config({handlers:!0}).$get(R.a.GET_LIVEINFO,{activityId:t.$route.params.id}).then(function(e){document.title=e.data.activity.title;var s=document.createElement("iframe");s.style.display="none",s.setAttribute("src","/");s.addEventListener("load",function t(){setTimeout(function(){s.removeEventListener("load",t),document.body.removeChild(s)},0)}),document.body.appendChild(s),t.logoImg=e.data.brand?e.data.brand.wapLogo:"",t.companyName=e.data.businessUserInfo.company,t.imgUrl=e.data.businessUserInfo.avatar,t.isShowSite=e.data.template,i=h()({},i,e.data.activity),a=e.data.joinInfo,i.setting=e.data.setting,i.warm=e.data.warm,i.statusName=me[i.status],t.playType=fe[i.status],t.playStatus=me[i.status],t.businessUserId=e.data.activity.userId,"LIVING"===i.status?"APPOINT"!==i.viewCondition||a.isApplay||t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id):"PLAYBACK"===i.status?"APPOINT"!==i.viewCondition||a.isApplay||t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id):"FINISH"===i.status?"APPOINT"!==i.viewCondition||a.isApplay||t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id):i.countDown<1800?"APPOINT"===i.viewCondition&&(a.isApplay||t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id)):t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id)}).catch(function(e){t.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:function(t){"cancel"===t.action||t.action}})});case 10:return e.next=12,t.$config({handlers:!0}).$get(R.a.GET_ONLINENUM,{activityId:t.$route.params.id}).then(function(t){i.onlineNum=t.data.onlineNum});case 12:t.storeActivityInfo(i),console.log(i),"vod"===t.playType?t.currentView=ot:t.currentView=ie,s=t.getLoginInfo(),_log.set("business_uid",i.userId),s&&_log.set("consumer_uid",s.consumerUserId),_log.set("activity_id",i.id),o=0,"LIVING"===i.status?o=1:"PLAYBACK"===i.status&&(o=2),_log.set("service_names",o),localStorage.getItem("refer_"+i.id)?_log.track(Vhall_User_Actions.ENTER,{event:parseInt(localStorage.getItem("refer_"+i.id))}):_log.track(Vhall_User_Actions.ENTER);case 23:case"end":return e.stop()}},e,t)}))()},initSdk:function(){},initRoomPaas:function(){var t=this,e=this.$route.query.shareid,i={activityId:this.activityId,__errHandler:!0};return e&&(i.shareId=e),new o.a(function(e,a){t.roomPaas.token&&e(t.roomPaas),t.$config({handlers:!0}).$get(le.a.GET_USERREGACTIVITY,i).then(function(e){t.storeJoinInfo(e.data)}).catch(function(e){12004===e.code||11030===e.code?t.doAuth(t.MOBILE_HOST+"guide/"+t.$route.params.id):12031===e.code&&t.$router.replace("/kicked")});var s=JSON.parse(sessionStorage.getItem("login"));t.$config({handlers:!0}).$get(R.a.GET_SDKTOKEN,{activityId:t.activityId,activityUserId:s?s.consumerUserId:t.sdkVisitorId}).then(function(i){i.data&&(e(i.data),t.storeRoomPaas(i.data))})})},share:function(){var t=this;return c()(r.a.mark(function e(){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.location.href,e.next=3,t.$config({handlers:!0}).$get(R.a.GET_SHARESIGN,{url:encodeURIComponent(i)}).then(function(e){t.wxShare.wxShareData.appId=e.data.appId,t.wxShare.wxShareData.timestamp=e.data.timestamp,t.wxShare.wxShareData.nonceStr=e.data.nonceStr,t.wxShare.wxShareData.signature=e.data.signature});case 3:return e.next=5,t.$config({handlers:!0}).$get(R.a.GET_SHAREINFO,{route:"live_route",param:t.$route.params.id}).then(function(e){if(e.data){var i=window.location.href;t.wxShare.shareData.shareDatalink=i,t.joinInfo.activityUserId&&(i=t.joinInfo.activityUserId?i+"?shareId="+t.joinInfo.activityUserId:i),t.wxShare.shareData.title=e.data.title?e.data.title:"",t.wxShare.shareData.shareDatadesc=e.data.description?e.data.description:"",t.wxShare.shareData.shareDataimgUrl=e.data.imgUrl?"https:"+t.$imgHost+"/"+e.data.imgUrl:""}});case 5:Object(re.a)(t.wxShare);case 6:case"end":return e.stop()}},e,t)}))()},loginSuccess:function(t){this.$config({handlers:!0}).$post(le.a.GET_VISITOR_INFO,{wechatAuth:sessionStorage.getItem("wechatAuth")}),_log.set("consumer_uid",t.consumerUserId),this.storeLoginInfo(t),this.$router.go(0)},isWx:function(){return!(-1===navigator.userAgent.toLowerCase().indexOf("micromessenger"))},initMsgServe:function(){var t=this;K.a.OBJ.init({accountId:this.roomPaas.accountId,token:this.roomPaas.token,appId:this.roomPaas.appId,channelId:this.roomPaas.channelRoom}),K.a.OBJ.regHandler(he,function(e){console.log("-----------收到红包消息------------"),console.log(e),e.type===pe&&(t.autoTime=e.time?parseInt(e.time):0,t.red_packet_id=e.red_packet_uuid,t.redBagCount=0,t.dealWithRedBag())}),K.a.OBJ.regHandler(it.a.endLive,function(){_log.track(Vhall_User_Actions.LEAVE),t.stopRedBag()})},handleRedBagClick:function(t){this.redBagTipShow=!1,this.redBagTimeDownShow=!1,this.redBagShow=!1,this.redBagNoneShow=!1},selectRedBag:function(t){this.redBagCount=t,console.log("点击到了 "+t+" 个红包")},endRainHandler:function(){var t=this;return c()(r.a.mark(function e(){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.rainTime=0,!t.redBagCount){e.next=7;break}return e.next=4,t.sendRedBag();case 4:t.redBagResultInfo.amount||(i=setTimeout(function(){clearTimeout(i),t.queryRedBagrecordList()},2e3)),e.next=8;break;case 7:t.queryRedBagrecordList();case 8:case"end":return e.stop()}},e,t)}))()},sendRedBag:function(){var t=this,e={activity_id:this.activityId,red_packet_id:this.red_packet_id,password:""};e.password||delete e.password,this.$config({handlers:!0}).$post(R.a.GET_RED_BAG,h()({},e)).then(function(e){200===e.code&&e.data&&(t.redBagShow=!0,t.redBagResultInfo=e.data)})},queryRedBagrecordList:function(){var t=this;this.redBagNoneShow=!0,this.$config({handlers:!0}).$post(R.a.GET_RED_BAG_RECOREDS,{red_packet_id:this.red_packet_id}).then(function(e){200===e.code&&e.data&&(t.redBagrecordList=e.data.list)})},stopRedBag:function(){clearInterval(this.timerInterval),clearInterval(this.redBagStartTimerInterval),this.redBagResultInfo={avatar:"",nick_name:"",amount:"",amount_ranking:"",percent:""},this.timer=0,this.redBagStartTimer=0,this.storeDownTimer(0),this.rainTime=0,this.autoTime=0,this.handleRedBagClick()},dealWithRedBag:function(){var t=this;this.$config({handlers:!0}).$post(R.a.GET_RED_BAG_INFO,{red_packet_id:this.red_packet_id}).then(function(e){200===e.code&&(t.redBagInfo={condition:e.data.condition,password:e.data.password},0===t.autoTime?t.redBagTimeDownShow=!0:(t.redBagTipShow=!0,t.redBagStartTimer=60*t.autoTime,t.redBagStartTimerInterval=setInterval(function(){if(t.storeDownTimer(t.redBagStartTimer),10===t.redBagStartTimer)return clearInterval(t.redBagStartTimerInterval),t.redBagStartTimer=0,t.storeDownTimer(0),t.redBagTipShow=!1,void(t.redBagTimeDownShow=!0);t.redBagStartTimer=t.redBagStartTimer-1},1e3)))})},showDownTip:function(){this.redBagStartTimer>10&&(this.redBagTipShow=!0)},PlaybackVideo:function(){z.a.$on("play_back_video_completed",function(t){_log.track(Vhall_User_Actions.LEAVE),console.log("回放播放完成了")})}})},ye=(i(300),Object(M.a)(ge,a,[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"fr v-my v-right",attrs:{href:"/m/user"}},[e("i",{staticClass:"v-showpsd iconfont icon-guanwang"}),this._v("我的")])}],!1,null,"3753a13b",null));ye.options.__file="src/pages/watch/watch.vue";e.default=ye.exports}}]);
//# sourceMappingURL=8.bdf9bde1.js.map