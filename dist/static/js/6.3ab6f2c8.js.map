{"version":3,"sources":["webpack:///./src/pages/guide/success.vue?411a","webpack:///./src/pages/guide/success.vue?19ed","webpack:///./src/pages/guide/success.vue?439f","webpack:///src/pages/guide/success.vue","webpack:///./src/pages/guide/success.vue"],"names":["_node_modules_mini_css_extract_plugin_0_4_3_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_1_0_0_css_loader_index_js_node_modules_vue_loader_15_4_2_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_2_1_6_postcss_loader_lib_index_js_node_modules_sass_loader_7_1_0_sass_loader_lib_loader_js_node_modules_vue_loader_15_4_2_vue_loader_lib_index_js_vue_loader_options_success_vue_vue_type_style_index_0_id_3ffef81c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","n","render","_vm","this","_h","$createElement","_c","_self","activity","countDown","status","staticClass","attrs","src","alt","_v","_m","on","click","accountSubmit","viewCondition","_e","_s","startTime","_withStripped","guide_successvue_type_script_lang_js_","mixins","login_mixin","data","MOBILE_HOST","user","phone","isApplay","isOrder","vhallParams","token","appId","channelId","accountId","mounted","components","created","getInfo","computed","Object","vuex_esm","chatParams","state","watch","methods","extends_default","setChatParams","mutation_types","doAuth","$route","params","id","initSdk","service","ChatService","init","handleActivityStart","msg","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","$config","handlers","$get","activity_service","GET_LIVEINFO","activityId","then","res","joinInfo","viewLimit","canAppoint","getToken","stop","_this2","$nextTick","regHandler","chat_config","BEGIN_LIVE","user_service","GET_USERREGACTIVITY","GET_SDKTOKEN","activityUserId","channelRoom","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/6.3ab6f2c8.js","sourcesContent":["import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.4.3@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@1.0.0@css-loader/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@2.1.6@postcss-loader/lib/index.js!../../../node_modules/_sass-loader@7.1.0@sass-loader/lib/loader.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./success.vue?vue&type=style&index=0&id=3ffef81c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.4.3@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@1.0.0@css-loader/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@2.1.6@postcss-loader/lib/index.js!../../../node_modules/_sass-loader@7.1.0@sass-loader/lib/loader.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./success.vue?vue&type=style&index=0&id=3ffef81c&lang=scss&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.activity.countDown < 1800 || _vm.activity.status === \"LIVING\"\n    ? _c(\"div\", { staticClass: \"v-success\" }, [\n        _c(\"img\", {\n          staticClass: \"v-img\",\n          attrs: { src: require(\"../../assets/image/success@2x.png\"), alt: \"\" }\n        }),\n        _vm._v(\" \"),\n        _vm._m(0),\n        _vm._v(\" \"),\n        _c(\n          \"button\",\n          { staticClass: \"primary-button\", on: { click: _vm.accountSubmit } },\n          [_vm._v(\"进入直播\")]\n        )\n      ])\n    : _c(\"div\", { staticClass: \"v-success\" }, [\n        _c(\"img\", {\n          staticClass: \"v-img\",\n          attrs: { src: require(\"../../assets/image/success@2x.png\"), alt: \"\" }\n        }),\n        _vm._v(\" \"),\n        _c(\"p\", { staticClass: \"v-success-title\" }, [\n          _vm.activity.viewCondition === \"APPOINT\"\n            ? _c(\"span\", [_vm._v(\"报名成功\")])\n            : _vm.activity.viewCondition === \"NONE\"\n              ? _c(\"span\", [_vm._v(\"预约成功\")])\n              : _vm._e()\n        ]),\n        _vm._v(\" \"),\n        _c(\"p\", [\n          _vm._v(\"活动将于\\n    \"),\n          _c(\"span\", { staticClass: \"v-red\" }, [\n            _vm._v(_vm._s(_vm.activity.startTime))\n          ]),\n          _vm._v(\"准时开播\")\n        ])\n      ])\n}\nvar staticRenderFns = [\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"p\", { staticClass: \"v-start-title\" }, [\n      _c(\"span\", [_vm._v(\"直播将要开始啦\")])\n    ])\n  }\n]\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./success.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./success.vue?vue&type=script&lang=js&\"","<template>\r\n  <div class=\"v-success\"\r\n       v-if=\"activity.countDown < 1800 || activity.status === 'LIVING'\">\r\n    <img src=\"../../assets/image/success@2x.png\"\r\n         alt=\"\"\r\n         class=\"v-img\">\r\n    <p class=\"v-start-title\">\r\n      <span>直播将要开始啦</span>\r\n    </p>\r\n    <button class=\"primary-button\"\r\n            @click=\"accountSubmit\">进入直播</button>\r\n  </div>\r\n  <div class=\"v-success\"\r\n       v-else>\r\n    <img src=\"../../assets/image/success@2x.png\"\r\n         alt=\"\"\r\n         class=\"v-img\">\r\n    <p class=\"v-success-title\">\r\n      <span v-if=\"activity.viewCondition === 'APPOINT'\">报名成功</span>\r\n      <span v-else-if=\"activity.viewCondition === 'NONE'\">预约成功</span>\r\n    </p>\r\n    <p>活动将于\r\n      <span class=\"v-red\">{{activity.startTime}}</span>准时开播</p>\r\n  </div>\r\n</template>\r\n<script>\r\nimport loginMixin from 'components/login-mixin'\r\nimport ChatService from '../../components/common/chat/ChatService.js'\r\nimport { mapMutations, mapState } from 'vuex'\r\nimport * as types from 'src/store/mutation-types'\r\nimport ChatConfig from 'src/api/chat-config'\r\nimport activityService from 'src/api/activity-service'\r\nimport userService from 'src/api/user-service'\r\nexport default {\r\n  mixins: [loginMixin],\r\n  data () {\r\n    return {\r\n      MOBILE_HOST: process.env.MOBILE_HOST,\r\n      activity: {\r\n        viewCondition: '', // APPOINT是报名活动 NONE是无限制活动\r\n        status: '', // 当前活动状态 LIVING 直播中\r\n        startTime: '', // 当前活动开始时间\r\n        countDown: ''\r\n      },\r\n      user: {\r\n        phone: '', // 无条件观看用户手机\r\n        isApplay: false, // 是否已经报名\r\n        isOrder: false // 是否已经预约\r\n      },\r\n      vhallParams: {\r\n        token: '',\r\n        appId: '',\r\n        channelId: '',\r\n        accountId: ''\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n  },\r\n  components: {\r\n  },\r\n  created () {\r\n    this.getInfo()\r\n  },\r\n  computed: mapState('tokenMager', {\r\n    chatParams: state => state.chatParams\r\n  }),\r\n  watch: {\r\n  },\r\n  methods: {\r\n    ...mapMutations('tokenMager', {\r\n      setChatParams: types.CHAT_PARAMS\r\n    }),\r\n    accountSubmit () {\r\n      this.doAuth(this.MOBILE_HOST + 'watch/' + this.$route.params.id)\r\n    },\r\n    initSdk () {\r\n      this.service = new ChatService()\r\n      this.service.init(this.vhallParams)\r\n      // window.Vhall.ready(() => {\r\n      // })\r\n    },\r\n    handleActivityStart (msg) {\r\n      this.activity.countDown = 1799\r\n    },\r\n    async getInfo () {\r\n      await this.$config({ handlers: true }).$get(activityService.GET_LIVEINFO, {\r\n        activityId: this.$route.params.id\r\n      }).then((res) => {\r\n        this.activity.viewCondition = res.data.activity.viewCondition\r\n        this.activity.status = res.data.activity.status\r\n        this.activity.startTime = res.data.activity.startTime\r\n        this.activity.countDown = res.data.activity.countDown\r\n        this.user.isApplay = res.data.joinInfo.isApplay\r\n        this.user.isOrder = res.data.joinInfo.isOrder\r\n        if ((this.activity.status === 'LIVING' || this.activity.countDown <= 1799) && !res.data.viewLimit.canAppoint) {\r\n          if (this.activity.viewCondition === 'APPOINT') {\r\n            if (res.data.joinInfo.isApplay) {\r\n              this.doAuth(this.MOBILE_HOST + 'watch/' + this.$route.params.id)\r\n            }\r\n          } else if (res.data.joinInfo.isOrder && this.activity.viewCondition === 'NONE') {\r\n            this.doAuth(this.MOBILE_HOST + 'watch/' + this.$route.params.id)\r\n          }\r\n        }\r\n      })\r\n      this.getToken()\r\n    },\r\n    getToken () {\r\n      if ((this.activity.viewCondition === 'APPOINT' && this.user.isApplay) || this.activity.viewCondition !== 'APPOINT') {\r\n        // 报名活动在已报名状态下和预约活动所有状态下可收到消息\r\n        if (!this.chatParams.token) {\r\n          // 当前vuex中没有聊天token 需要获取\r\n          this.$config({ handlers: true }).$get(userService.GET_USERREGACTIVITY, { // 获取参会信息\r\n            activityId: this.$route.params.id\r\n          }).then((res) => {\r\n            this.$config({ handlers: true }).$get(activityService.GET_SDKTOKEN, { // 获取观看端token\r\n              activityId: this.$route.params.id,\r\n              activityUserId: res.data.activityUserId\r\n            }).then((res) => {\r\n              this.vhallParams.token = res.data.token\r\n              this.vhallParams.appId = res.data.appId\r\n              this.vhallParams.channelId = res.data.channelRoom\r\n              this.vhallParams.accountId = res.data.accountId // 从参会接口取activiUserID\r\n              this.setChatParams(this.vhallParams)\r\n              this.$nextTick(() => {\r\n                this.initSdk()\r\n                this.service.regHandler(ChatConfig.BEGIN_LIVE, this.handleActivityStart)\r\n              })\r\n            })\r\n          })\r\n        } else {\r\n          this.vhallParams = this.chatParams\r\n          this.$nextTick(() => {\r\n            this.initSdk()\r\n            this.service.regHandler(ChatConfig.BEGIN_LIVE, this.handleActivityStart)\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import '~assets/css/mixin.scss';\r\n.v-success {\r\n  .v-img {\r\n    display: block;\r\n    width: 224px;\r\n    margin: 0 auto;\r\n  }\r\n  p {\r\n    text-align: center;\r\n    margin-top: 22px;\r\n    font-size: 28px;\r\n    color: #222;\r\n    &.v-success-title,\r\n    &.v-start-title {\r\n      font-size: 40px;\r\n    }\r\n    .v-red {\r\n      color: #fc5659;\r\n    }\r\n  }\r\n  .primary-button {\r\n    width: 490px;\r\n    height: 90px;\r\n    border-radius: 50px;\r\n    display: block;\r\n    margin: 25px auto 5px;\r\n  }\r\n}\r\n</style>\r\n","import { render, staticRenderFns } from \"./success.vue?vue&type=template&id=3ffef81c&scoped=true&\"\nimport script from \"./success.vue?vue&type=script&lang=js&\"\nexport * from \"./success.vue?vue&type=script&lang=js&\"\nimport style0 from \"./success.vue?vue&type=style&index=0&id=3ffef81c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3ffef81c\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\work\\\\vhall\\\\fe_interaction_h5\\\\node_modules\\\\_vue-hot-reload-api@2.3.1@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('3ffef81c', component.options)\n    } else {\n      api.reload('3ffef81c', component.options)\n    }\n    module.hot.accept(\"./success.vue?vue&type=template&id=3ffef81c&scoped=true&\", function () {\n      api.rerender('3ffef81c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/guide/success.vue\"\nexport default component.exports"],"sourceRoot":""}