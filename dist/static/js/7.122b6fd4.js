(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{196:function(e,t,i){},243:function(e,t,i){"use strict";var s=i(196);i.n(s).a},294:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"v-checkState"},[e.user.isDisabled?i("com-input",{attrs:{inputVal:e.user.phone,placeholder:"请输入手机号",maxLength:11,isDisabled:"disabled",errorMsg:e.phoneError},on:{"update:inputVal":function(t){e.$set(e.user,"phone",t)},"update:errorMsg":function(t){e.phoneError=t}}}):i("com-input",{attrs:{inputVal:e.user.phone,placeholder:"请输入手机号",maxLength:11,errorMsg:e.phoneError},on:{"update:inputVal":function(t){e.$set(e.user,"phone",t)},"update:errorMsg":function(t){e.phoneError=t}}}),e._v(" "),e.user.isDisabled?e._e():i("com-verification-code",{attrs:{phone:e.user.phone,inputVal:e.code,code:e.code,isGetCode:e.isGetCode,placeholder:"输入验证码",maxLength:6,errorMsg:e.codeError,codeType:"CONSUMER_USER_LOGIN"},on:{"update:inputVal":function(t){e.code=t},"update:code":function(t){e.code=t},inputFocus:function(t){e.getCode(t)},"update:errorMsg":function(t){e.codeError=t}}}),e._v(" "),i("button",{staticClass:"primary-button",on:{click:e.submit}},[e._v("提交")])],1)};s._withStripped=!0;var o=i(11),r=i.n(o),a=i(221),n=i(223),c=i(182),h=i(58),d={data:()=>({code:"",isGetCode:!0,activity:{viewCondition:"APPOINT",status:""},user:{phone:"",isApplay:!1,isOrder:!1,isDisabled:!1},codeError:"",phoneError:""}),mounted(){},components:{"com-input":a.a,"com-verification-code":n.a},created(){this.getActivity();let e=JSON.parse(sessionStorage.getItem("login"));e&&(this.user.phone=e.mobile,this.user.phone&&(this.user.isDisabled=!0))},watch:{},methods:{getCode(e){this.code=e},subScribe(){let e={activityId:this.$route.params.id};this.$config({handlers:!0}).$post(c.a.POST_SUBSCRIBE,e).then(e=>{this.$router.replace("/guid/"+this.$route.params.id)}).catch(e=>{this.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:e=>{"cancel"===e.action||e.action}})})},submit(){return this.verification(this.user.phone,"Y","mobile")?this.user.isDisabled||this.verification(this.code,"Y","integer")?void(this.user.isOrder||this.user.isDisabled?this.subScribe():this.$config({handlers:!0}).$post(h.a.POST_MOBILELOGIN,{mobile:this.user.phone,code:this.code,wechatAuth:sessionStorage.getItem("wechatAuth")}).then(e=>{e.data?(sessionStorage.setItem("login",r()(e.data)),this.$config({handlers:!0}).$get(c.a.GET_LIVEINFO,{activityId:this.$route.params.id}).then(e=>{e.data.joinInfo.isOrder?this.$router.replace("/guid/"+this.$route.params.id):this.subScribe()}).catch(e=>{this.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:e=>{"cancel"===e.action||e.action}})})):(this.$messageBox({header:"提示",content:e.msg,confirmText:"确定",handleClick:e=>{"cancel"===e.action||e.action}}),sessionStorage.removeItem("login"),sessionStorage.removeItem("wechatAuth"))})):(this.codeError="请输入正确验证码",!1):(this.phoneError="请正确填写手机号",!1)},verification(e,t,i){let s=/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,o=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,r=/^[0-9]*$/;if("mobile"===i&&(e=""===this.user.phone?e:this.user.phone),""===e){if("Y"===t)return!1}else switch(i){case"mobile":return e=""===this.user.phone?e:this.user.phone,s.test(e);case"integer":return r.test(e);case"email":return o.test(e)}return!0},getActivity(){this.$config({handlers:!0}).$get(c.a.GET_LIVEINFO,{activityId:this.$route.params.id}).then(e=>{this.activity.viewCondition=e.data.activity.viewCondition,this.activity.status=e.data.activity.status,this.user.isApplay=e.data.joinInfo.isApplay,this.user.isOrder=e.data.joinInfo.isOrder})}}},u=(i(243),i(1)),p=Object(u.a)(d,s,[],!1,null,"40b23aa5",null);p.options.__file="src/pages/guide/check-state.vue";t.default=p.exports}}]);
//# sourceMappingURL=7.122b6fd4.js.map